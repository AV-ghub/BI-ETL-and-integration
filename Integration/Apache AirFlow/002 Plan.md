| **Ð‘Ð»Ð¾Ðº Ð¸Ð·ÑƒÑ‡ÐµÐ½Ð¸Ñ** | **ÐšÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ñ‚ÐµÐ¼Ð°** | **Ð’Ð°ÑˆÐ° Ñ†ÐµÐ»ÑŒ** |
| :--- | :--- | :--- |
| **Ð‘Ð»Ð¾Ðº 1: Ð¤ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚** | Python + Ð‘Ð°Ð·Ð¾Ð²Ð°Ñ Ð¸Ð´ÐµÐ¾Ð»Ð¾Ð³Ð¸Ñ Airflow | ÐÐ°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð¸ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ DAG. ÐŸÐ¾Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ DAG, Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€, Ð·Ð°Ð´Ð°Ñ‡Ð°. |
| **Ð‘Ð»Ð¾Ðº 2: ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°** | ÐšÐ°Ðº Airflow Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¸Ð·Ð½ÑƒÑ‚Ñ€Ð¸ | ÐžÐ±ÑŠÑÑÐ½Ð¸Ñ‚ÑŒ Ð½Ð° ÑÐ¾Ð±ÐµÑÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ð¸ Ñ€Ð¾Ð»ÑŒ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð² (Scheduler, Executor, Worker) Ð¸ Ñ‚Ð¸Ð¿Ñ‹ Executor. |
| **Ð‘Ð»Ð¾Ðº 3: ÐŸÑ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ°** | Ð ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ | Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ð¹ ETL-DAG Ñ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼Ð¸, ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð¾Ð¼ Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¾Ð¹ Ð¾ÑˆÐ¸Ð±Ð¾Ðº. |

Ð”Ð°Ð»ÐµÐµ â€” Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ñ‹Ð¹ Ñ€Ð°Ð·Ð±Ð¾Ñ€ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð±Ð»Ð¾ÐºÐ°.

### Ð‘Ð»Ð¾Ðº 1: Ð¤ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚ (Python + Core Concepts)
Ð¦ÐµÐ»ÑŒ ÑÑ‚Ð¾Ð³Ð¾ Ð±Ð»Ð¾ÐºÐ° â€” Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ð¹ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ Airflow Ð¸ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ²Ð¾Ð¹ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ DAG (Directed Acyclic Graph), Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Python.

**ðŸŽ¯ Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ:**
1.  **Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Airflow Ñ‡ÐµÑ€ÐµÐ· Docker** â€” ÑÑ‚Ð¾ ÑÐ°Ð¼Ñ‹Ð¹ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð¸ Ñ‡Ð¸ÑÑ‚Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð±ÐµÐ· ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ð¾Ð² Ñ Ð²Ð°ÑˆÐ¸Ð¼ Python. Ð¡Ð»ÐµÐ´ÑƒÐ¹Ñ‚Ðµ Ð¾Ñ„Ð¸Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ð³Ð°Ð¹Ð´Ñƒ . ÐŸÐ¾ÑÐ»Ðµ `docker compose up` Ð²ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð½Ð° `localhost:8080` (Ð»Ð¾Ð³Ð¸Ð½/Ð¿Ð°Ñ€Ð¾Ð»ÑŒ: `airflow`).
2.  **Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚Ðµ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÐºÐ¾Ð½Ñ†ÐµÐ¿Ñ†Ð¸Ð¸ Ð² Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸:**
    *   **Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Airflow?** â€” Ð­Ñ‚Ð¾ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° Ð´Ð»Ñ Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð·Ð°Ð´Ð°Ñ‡ (workflows as code) .
    *   **DAG (Directed Acyclic Graph)** â€” Ð­Ñ‚Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð²ÑÐµÐ³Ð¾ Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ³Ð¾ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°: Ð·Ð°Ð´Ð°Ñ‡Ð¸, Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸, Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ .
    *   **ÐžÐ¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€ (Operator)** â€” ÑˆÐ°Ð±Ð»Ð¾Ð½ Ð´Ð»Ñ Ð¾Ð´Ð½Ð¾Ð¹ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `BashOperator`, `PythonOperator`) .
    *   **Ð—Ð°Ð´Ð°Ñ‡Ð° (Task)** â€” ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¹ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ð° Ð² DAG .
3.  **ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ ÑÐ²Ð¾Ð¹ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ DAG.** ÐŸÐ¾Ð¼ÐµÑÑ‚Ð¸Ñ‚Ðµ `.py` Ñ„Ð°Ð¹Ð» Ð² Ð¿Ð°Ð¿ÐºÑƒ `./dags`. Ð’Ð¾Ñ‚ Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ ÑÐ¾ÐµÐ´Ð¸Ð½ÑÐµÑ‚ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Python Ñ ÐºÐ¾Ð½Ñ†ÐµÐ¿Ñ†Ð¸ÑÐ¼Ð¸ Airflow:

```python
# Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚. Ð­Ñ‚Ð¾ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð½Ð°Ð±Ð¾Ñ€ Ð´Ð»Ñ ÑÑ‚Ð°Ñ€Ñ‚Ð°.
from airflow import DAG
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

# ÐŸÑ€Ð¾ÑÑ‚Ð°Ñ Python-Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ, ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ð¼Ñ‹ Ð¿Ñ€ÐµÐ²Ñ€Ð°Ñ‚Ð¸Ð¼ Ð² Ð·Ð°Ð´Ð°Ñ‡Ñƒ.
def say_hello():
    print("ÐŸÑ€Ð¸Ð²ÐµÑ‚ Ð¾Ñ‚ Apache Airflow!")

def calculate(**context):
    # Airflow Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿ÐµÑ€ÐµÐ´Ð°ÐµÑ‚ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ.
    x = 5
    y = 3
    result = x + y
    print(f"Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ: {result}")
    # ÐœÐ¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð´Ð»Ñ Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ð·Ð°Ð´Ð°Ñ‡ (Ð¾ Ð½Ð¸Ñ… Ð¿Ð¾Ð·Ð¶Ðµ).
    return result

# ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ DAG.
with DAG(
    dag_id='my_first_dag',          # Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð¸Ð¼Ñ
    start_date=datetime(2025, 1, 5), # Ð”Ð°Ñ‚Ð° Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
    schedule=timedelta(days=1),     # Ð—Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ Ñ€Ð°Ð· Ð² Ð´ÐµÐ½ÑŒ
    catchup=False                   # ÐÐµ Ð½Ð°Ð³Ð¾Ð½ÑÑ‚ÑŒ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ¸
) as dag:

    # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (Tasks), Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ñ‹.
    task_hello = PythonOperator(
        task_id='print_hello',      # Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ID Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… DAG
        python_callable=say_hello   # Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Python-Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ
    )

    task_calc = PythonOperator(
        task_id='calculate_something',
        python_callable=calculate
    )

    # ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº: task_hello -> task_calc
    task_hello >> task_calc
```

**Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð´Ð»Ñ ÑÐ°Ð¼Ð¾Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¿Ð¾ÑÐ»Ðµ Ð±Ð»Ð¾ÐºÐ°:**
*   ÐšÐ°ÐºÐ¾Ð¹ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð¾Ð¹ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Airflow Ð² Docker?
*   Ð’ Ñ‡ÐµÐ¼ Ñ€Ð°Ð·Ð½Ð¸Ñ†Ð° Ð¼ÐµÐ¶Ð´Ñƒ DAG Ð¸ Task?
*   ÐšÐ°Ðº `PythonOperator` ÑÐ²ÑÐ·Ñ‹Ð²Ð°ÐµÑ‚ ÐºÐ¾Ð´ Ð½Ð° Python Ñ Airflow?

### Ð‘Ð»Ð¾Ðº 2: ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° (ÐšÐ°Ðº ÑÑ‚Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚)
ÐšÐ¾Ð³Ð´Ð° Ð²Ñ‹ Ð¿Ð¾Ð½ÑÐ»Ð¸, ÐºÐ°Ðº ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ DAG, Ð²Ð°Ð¶Ð½Ð¾ Ñ€Ð°Ð·Ð¾Ð±Ñ€Ð°Ñ‚ÑŒÑÑ, ÐºÐ°Ðº Airflow ÐµÐ³Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚. Ð­Ñ‚Ð¾ ÐºÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ñ‚ÐµÐ¼Ð° Ð´Ð»Ñ ÑÐ¾Ð±ÐµÑÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ.

**ðŸŽ¯ Ð§Ñ‚Ð¾ Ð¸Ð·ÑƒÑ‡Ð°Ñ‚ÑŒ:**
1.  **ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Airflow:**
    *   **Scheduler** â€” ÑÐ»ÐµÐ´Ð¸Ñ‚ Ð·Ð° DAG Ð¸ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ¸ Ð·Ð°Ð´Ð°Ñ‡ .
    *   **Executor** â€” Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚, *Ð³Ð´Ðµ* Ð¸ *ÐºÐ°Ðº* Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑŽÑ‚ÑÑ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾ â€” `SequentialExecutor`, Ð² ÐºÐ»Ð°ÑÑ‚ÐµÑ€Ðµ â€” `CeleryExecutor`) .
    *   **Worker** â€” Ð¿Ñ€Ð¾Ñ†ÐµÑÑÑ‹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½ÐµÐ¿Ð¾ÑÑ€ÐµÐ´ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑŽÑ‚ ÐºÐ¾Ð´ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (ÐµÑÑ‚ÑŒ Ð¿Ñ€Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ð¸ `CeleryExecutor`) .
    *   **Web Server** â€” Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ UI Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ .
    *   **Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… (MetaDatabase)** â€” Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð²ÑÐµÑ… DAG, Ð·Ð°Ð´Ð°Ñ‡, Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¹ .
2.  **Ð¢Ð¸Ð¿Ñ‹ Executor** â€” Ð² Ñ‡ÐµÐ¼ Ñ€Ð°Ð·Ð½Ð¸Ñ†Ð° Ð¸ ÐºÐ¾Ð³Ð´Ð° Ñ‡Ñ‚Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ:
    *   `SequentialExecutor` (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð² Docker-ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²).
    *   `CeleryExecutor` Ð´Ð»Ñ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ .
    *   `KubernetesExecutor` Ð´Ð»Ñ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¸Ð·Ð¾Ð»ÑÑ†Ð¸Ð¸ Ð¸ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² K8s .

**Ð—Ð°Ð´Ð°Ð½Ð¸Ðµ:** ÐÐ° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Docker  Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚Ðµ, ÐºÐ°ÐºÐ¸Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ñ‹ (`docker ps`) Ð¸ ÐºÐ°ÐºÐ¾Ð¹ Executor Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð² Docker Compose â€” `CeleryExecutor`).

**Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð´Ð»Ñ ÑÐ°Ð¼Ð¾Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸:**
*   ÐšÐ°ÐºÑƒÑŽ Ñ€Ð¾Ð»ÑŒ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ Scheduler?
*   Ð’ Ñ‡ÐµÐ¼ Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¿Ñ€Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð¸Ðµ Ð¼ÐµÐ¶Ð´Ñƒ `SequentialExecutor` Ð¸ `CeleryExecutor`?
*   Ð“Ð´Ðµ Airflow Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡?

### Ð‘Ð»Ð¾Ðº 3: ÐŸÑ€Ð¾Ð´Ð²Ð¸Ð½ÑƒÑ‚Ð°Ñ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ° (Ð ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹)
Ð—Ð´ÐµÑÑŒ Ð¼Ñ‹ ÑÐ¾Ð±ÐµÑ€ÐµÐ¼ Ð²ÑÑ‘ Ð²Ð¼ÐµÑÑ‚Ðµ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð´Ð¸Ð¼ DAG, Ð±Ð»Ð¸Ð·ÐºÐ¸Ð¹ Ðº Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ ETL.

**ðŸŽ¯ Ð§Ñ‚Ð¾ Ð¾ÑÐ²Ð°Ð¸Ð²Ð°Ñ‚ÑŒ:**
1.  **ÐŸÐµÑ€ÐµÐ´Ð°Ñ‡Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¼ÐµÐ¶Ð´Ñƒ Ð·Ð°Ð´Ð°Ñ‡Ð°Ð¼Ð¸** â€” Ñ‡ÐµÑ€ÐµÐ· `XCom` (cross-communication). ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð·Ð°Ð´Ð°Ñ‡Ðµ `extract` Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ðµ `transform`.
2.  **Ð¨Ð°Ð±Ð»Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ (Jinja)** Ð¸ **ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ** â€” Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð´Ð°Ñ‚Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° (`{{ ds }}`) Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Python-Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹.
3.  **ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº** â€” Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ `retries`, `retry_delay`, `email_on_failure` Ð² `default_args`.
4.  **Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑÐ¼Ð¸** â€” ÑÐ»Ð¾Ð¶Ð½Ñ‹Ðµ ÑÐ²ÑÐ·Ð¸ Ñ‡ÐµÑ€ÐµÐ· `[task1, task2] >> task3`.

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ñ€Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ DAG (ETL-ÑÐºÐµÐ»ÐµÑ‚):**
```python
from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.providers.http.operators.http import SimpleHttpOperator
from airflow.providers.postgres.operators.postgres import PostgresOperator
from datetime import datetime
import json

def _transform_data(**context):
    # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ñ‡ÐµÑ€ÐµÐ· XCom
    ti = context['ti']
    extracted_data = ti.xcom_pull(task_ids='extract_data_from_api')
    # ÐŸÑ€Ð¾ÑÑ‚Ð°Ñ Ñ‚Ñ€Ð°Ð½ÑÑ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð½Ð° Python
    transformed_data = [item for item in extracted_data if item['value'] > 10]
    return transformed_data

with DAG(
    dag_id='simple_etl_pipeline',
    start_date=datetime(2025, 1, 1),
    schedule='@daily',
    default_args={'retries': 2}
) as dag:

    # Extract: Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· API
    extract = SimpleHttpOperator(
        task_id='extract_data_from_api',
        endpoint='/data',
        method='GET',
        response_filter=lambda response: json.loads(response.text)
    )

    # Transform: Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Python
    transform = PythonOperator(
        task_id='transform_data',
        python_callable=_transform_data
    )

    # Load: Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð² Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð¿Ñ€Ð¸Ð¼ÐµÑ€ SQL)
    load = PostgresOperator(
        task_id='load_to_postgres',
        sql='INSERT INTO my_table VALUES ({{ ti.xcom_pull(task_ids="transform_data") }})'
    )

    # ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ
    extract >> transform >> load
```

**Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð´Ð»Ñ ÑÐ°Ð¼Ð¾Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸:**
*   ÐšÐ°Ðº Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‚ÑŒ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð¸Ð· Ð·Ð°Ð´Ð°Ñ‡Ð¸ `extract` Ð² Ð·Ð°Ð´Ð°Ñ‡Ñƒ `transform`?
*   ÐšÐ°Ðº ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ñ‚Ð°Ðº, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð·Ð°Ð´Ð°Ñ‡Ð° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ð»Ð°ÑÑŒ 3 Ñ€Ð°Ð·Ð° Ñ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ð¾Ð¼ Ð² 5 Ð¼Ð¸Ð½ÑƒÑ‚ Ð¿Ñ€Ð¸ Ð¿Ð°Ð´ÐµÐ½Ð¸Ð¸?
*   Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ `{{ ds }}` Ð² SQL-Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ðµ Ð¸ Ð¾Ñ‚ÐºÑƒÐ´Ð° ÑÑ‚Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð±ÐµÑ€ÐµÑ‚ÑÑ?

### ðŸ§  ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ñ‚ÐµÐ¼Ñ‹ Ð´Ð»Ñ ÑÐ¾Ð±ÐµÑÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ
Ð¡Ð²ÐµÐ´ÐµÐ¼ Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÐµÐ½Ð¸Ñ:

| **Ð¢ÐµÐ¼Ð°** | **Ð§Ñ‚Ð¾ Ð½ÑƒÐ¶Ð½Ð¾ Ð·Ð½Ð°Ñ‚ÑŒ** |
| :--- | :--- |
| **Ð˜Ð´ÐµÐ¾Ð»Ð¾Ð³Ð¸Ñ** | Â«Workflow as CodeÂ», ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ SSIS (Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ vs. ETL-Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚). |
| **DAG** | ÐÐ°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¹ Ð°Ñ†Ð¸ÐºÐ»Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð³Ñ€Ð°Ñ„, `dag_id`, `start_date`, `schedule`, `catchup`. |
| **Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð¸ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸** | ÐžÐ¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€ (Operator) vs. Ð—Ð°Ð´Ð°Ñ‡Ð° (Task), `>>` Ð¸ `<<` Ð´Ð»Ñ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹, `cross_downstream`. |
| **ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°** | Ð Ð¾Ð»Ð¸ Scheduler, Executor, Worker, Web Server. Ð Ð°Ð·Ð½Ð¸Ñ†Ð° Ð¼ÐµÐ¶Ð´Ñƒ `CeleryExecutor` Ð¸ `KubernetesExecutor`. |
| **ÐŸÐµÑ€ÐµÐ´Ð°Ñ‡Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…** | XCom Ð´Ð»Ñ Ð¼Ð°Ð»Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…. Ð”Ð»Ñ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ñ… â€” Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð²Ð½ÐµÑˆÐ½ÐµÐ³Ð¾ Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ð° (S3, HDFS). |
| **Ð–Ð¸Ð·Ð½ÐµÐ½Ð½Ñ‹Ð¹ Ñ†Ð¸ÐºÐ» Ð·Ð°Ð´Ð°Ñ‡Ð¸** | Ð¡Ñ‚Ð°Ñ‚ÑƒÑÑ‹ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (success, failed, running, skipped). ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ `retries`, `retry_delay`. |
| **Ð›ÑƒÑ‡ÑˆÐ¸Ðµ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸** | Ð˜Ð´ÐµÐ¼Ð¿Ð¾Ñ‚ÐµÐ½Ñ‚Ð½Ð¾ÑÑ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡ (Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ð´Ð°ÐµÑ‚ Ñ‚Ð¾Ñ‚ Ð¶Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚). Ð’Ñ‹Ð½Ð¾Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Ð² Variables Ð¸ Connections. |
