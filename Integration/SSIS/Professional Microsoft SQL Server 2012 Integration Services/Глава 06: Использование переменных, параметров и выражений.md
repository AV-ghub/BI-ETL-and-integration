## **–ì–ª–∞–≤–∞ 6: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–π**

–≠—Ç–∞ –≥–ª–∞–≤–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ **–¥–∏–Ω–∞–º–∏–∑–º—É –≤ SSIS**. –ê–≤—Ç–æ—Ä—ã –ø–æ–¥—Ä–æ–±–Ω–æ –æ–±—ä—è—Å–Ω—è—é—Ç, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–Ω–µ—à–Ω–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (–≤—ã—Ä–∞–∂–µ–Ω–∏—è) –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä—è–º–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞.

---

### üìå **–¢—Ä–∏ –∫–∏—Ç–∞ –¥–∏–Ω–∞–º–∏–∑–º–∞ –≤ SSIS:**

1.  **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (Variables):** –•—Ä–∞–Ω—è—Ç –∑–Ω–∞—á–µ–Ω–∏—è **–≤–Ω—É—Ç—Ä–∏** –ø–∞–∫–µ—Ç–∞. –û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ (scope) –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–∞–∫–µ—Ç, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∑–∞–¥–∞—á–∞.
2.  **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (Parameters):** –ü–æ—Ö–æ–∂–∏ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π **–∏–∑–≤–Ω–µ** (–ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–∞–∫–µ—Ç–∞, –∏–∑ —Å—Ä–µ–¥—ã). –ü—Ä–∏—à–ª–∏ –≤ SSIS 2012, –∑–∞–º–µ–Ω–∏–≤ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Configurations).
3.  **–í—ã—Ä–∞–∂–µ–Ω–∏—è (Expressions):** –ö–æ–¥ –Ω–∞ **—è–∑—ã–∫–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–π SSIS** (–ø–æ—Ö–æ–∂ –Ω–∞ C#), –∫–æ—Ç–æ—Ä—ã–π –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ runtime. –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏—Å–≤–æ–µ–Ω —Å–≤–æ–π—Å—Ç–≤–∞–º –∑–∞–¥–∞—á, –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

---

### **1. –û–±–∑–æ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (Variable Overview)**

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±–º–µ–Ω–∞ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –ø–∞–∫–µ—Ç–∞.
- **–û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ (Scope):**
    - **Package:** –í–∏–¥–Ω–∞ –≤–µ–∑–¥–µ –≤ –ø–∞–∫–µ—Ç–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
    - **Container (Sequence, For Loop, Foreach Loop):** –í–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏—Ö –∑–∞–¥–∞—á. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–º—ë–Ω.
    - **Task:** –í–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–π –∑–∞–¥–∞—á–∏.
- **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (System Variables):** –ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã SSIS (–Ω–∞–ø—Ä–∏–º–µ—Ä, `PackageName`, `StartTime`, `MachineName`). –î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è.
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (User Variables):** –°–æ–∑–¥–∞—é—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.

**–ì–¥–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å:** –û–∫–Ω–æ **Variables** (SSIS ‚Üí Variables –∏–ª–∏ –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ –≤ –¥–∏–∑–∞–π–Ω–µ—Ä–µ).

---

### **2. –û–±–∑–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (Parameter Overview)**

- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π **–∏–∑–≤–Ω–µ –ø–∞–∫–µ—Ç–∞** –¥–ª—è –µ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
- **–¢–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
    - **Project Parameters:** –í–∏–¥–Ω—ã –≤—Å–µ–º –ø–∞–∫–µ—Ç–∞–º –≤ –ø—Ä–æ–µ–∫—Ç–µ. –ò–¥–µ–∞–ª—å–Ω—ã –¥–ª—è –æ–±—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ staging-–±–∞–∑–µ).
    - **Package Parameters:** –í–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞.
- **–°–≤–æ–π—Å—Ç–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:** **Value** (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), **Sensitive** (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, –¥–ª—è –ø–∞—Ä–æ–ª–µ–π), **Required** (–ø–∞–∫–µ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±–µ–∑ –µ–≥–æ –ø–µ—Ä–µ–¥–∞—á–∏).
- **–ö–∞–∫ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è:** –ß–µ—Ä–µ–∑ —Å—Ä–µ–¥—É (Environment) –≤ –∫–∞—Ç–∞–ª–æ–≥–µ SSISDB, —á–µ—Ä–µ–∑ `DTExec`, —á–µ—Ä–µ–∑ —Ö—Ä–∞–Ω–∏–º—É—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É `catalog.start_execution`.

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã **–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤–Ω—É—Ç—Ä–∏ –ø–∞–∫–µ—Ç–∞** –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –û–Ω–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

---

### **3. –û–±–∑–æ—Ä –≤—ã—Ä–∞–∂–µ–Ω–∏–π (Expression Overview)**

- **–Ø–∑—ã–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–π SSIS:** –ü–æ—Ö–æ–∂ –Ω–∞ C#, –Ω–æ –Ω–µ –∏–¥–µ–Ω—Ç–∏—á–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
    1.  **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:** –ü–µ—Ä–µ–º–µ–Ω–Ω–æ–π –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ, –∏ –µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏.
    2.  **–ó–∞–¥–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (Property Expressions):** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ConnectionString –∑–∞–¥–∞—á–∏, –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É, —É—Å–ª–æ–≤–∏—è –≤ Precedence Constraint.
- **–ì–¥–µ –∑–∞–¥–∞—é—Ç—Å—è:**
    - –í –æ–∫–Ω–µ —Å–≤–æ–π—Å—Ç–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ ‚Üí —Å–≤–æ–π—Å—Ç–≤–æ `Expressions`.
    - –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ **Precedence Constraint** (Evaluation Operation = Expression).
    - –í –æ–∫–Ω–µ **Variables** (—Å—Ç–æ–ª–±–µ—Ü Expression).

---

### **4. –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (Understanding Data Types)**

–≠—Ç–æ –≤–∞–∂–Ω–µ–π—à–∏–π —Ä–∞–∑–¥–µ–ª –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –∏ –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.

- **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö SSIS vs SQL Server:** SSIS –∏–º–µ–µ—Ç —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ç–∏–ø–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DT_STR`, `DT_I4`, `DT_DATE`). –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –∏–¥–µ–∞–ª—å–Ω–æ–µ.
- **–ü—Ä–æ–±–ª–µ–º—ã —Å –¥–∞—Ç–∞–º–∏:** –¢–∏–ø `DT_DATE` –≤ SSIS —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `DATETIME` –≤ SQL Server, –Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º (—Å 1 —è–Ω–≤–∞—Ä—è 1000 –≥–æ–¥–∞). –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `DT_DBTIMESTAMP`.
- **–ü—Ä–æ–±–ª–µ–º—ã —Å Unicode:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ `DT_STR` (–Ω–µ-Unicode, `varchar`) –∏ `DT_WSTR` (Unicode, `nvarchar`). –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ—è–≤–Ω—ã–º –∫–æ–Ω–≤–µ—Ä—Å–∏—è–º –∏ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö.
- **–ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ (Casting):** –í –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è `(DT_STR, 50, 1252)` –∏–ª–∏ `(DT_DATE)`.

**–î–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è:** *"–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—é —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Å—Ç—Ä–æ–∫ –∏ –¥–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É—é Data Conversion —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –Ω–µ –Ω–∞–≥—Ä—É–∂–∞—Ç—å –∫–æ–Ω–≤–µ–π–µ—Ä –ª–∏—à–Ω–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏."*

---

### **5. –†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏**

- **–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:** –í –æ–∫–Ω–µ Variables, –∑–∞–¥–∞—Ç—å –∏–º—è, —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö, –∑–Ω–∞—á–µ–Ω–∏–µ.
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö:** –°–∏–Ω—Ç–∞–∫—Å–∏—Å `@[Namespace::VariableName]` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@[User::FileName]`). –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî `User`.
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:** –°–∏–Ω—Ç–∞–∫—Å–∏—Å `@[$Project::ParameterName]` –∏–ª–∏ `@[$Package::ParameterName]`.
- **–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**
    - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –¥–ª—è –≤—Å–µ–≥–æ, —á—Ç–æ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –ø—Ä–∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–∏ (—Å–µ—Ä–≤–µ—Ä–∞, –ø—É—Ç–∏, –∏–º–µ–Ω–∞ –±–∞–∑).
    - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, —Ç–µ–∫—É—â–µ–µ –∏–º—è —Ñ–∞–π–ª–∞).
    - –ü—Ä–∏—Å–≤–∞–∏–≤–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º **–≤—ã—Ä–∞–∂–µ–Ω–∏—è**, —á—Ç–æ–±—ã –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã—á–∏—Å–ª—è–ª–∏—Å—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏.

---

### **6. –†–∞–±–æ—Ç–∞ —Å –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ (Working with Expressions) ‚Äî –°–ê–ú–û–ï –í–ê–ñ–ù–û–ï**

–ê–≤—Ç–æ—Ä—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—é—Ç **—Å–∏–Ω—Ç–∞–∫—Å–∏—Å —è–∑—ã–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∏–π SSIS** –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–æ–≤.

#### **A. –û—Å–Ω–æ–≤—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ (–ø–æ—Ö–æ–∂ –Ω–∞ C#):**
- **–û–ø–µ—Ä–∞—Ç–æ—Ä—ã:** `==`, `!=`, `>`, `<`, `&&`, `||`, `!`, `+`, `-`, `*`, `/`, `%`.
- **–¢–µ—Ä–Ω–∞—Ä–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä:** `(—É—Å–ª–æ–≤–∏–µ) ? –∑–Ω–∞—á–µ–Ω–∏–µ_–µ—Å–ª–∏_–∏—Å—Ç–∏–Ω–∞ : –∑–Ω–∞—á–µ–Ω–∏–µ_–µ—Å–ª–∏_–ª–æ–∂—å`
- **–í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π:** –§—É–Ω–∫—Ü–∏–∏ SSIS –∏ .NET (–Ω–æ –Ω–µ –≤—Å–µ!). –ù–∞–ø—Ä–∏–º–µ—Ä, `SUBSTRING`, `GETDATE()`, `REPLACENULL`.

#### **B. –ü–æ—Å—Ç—Ä–æ–∏—Ç–µ–ª—å –≤—ã—Ä–∞–∂–µ–Ω–∏–π (Expression Builder):**
–í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏–π. –°–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ä–µ–≤–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ñ—É–Ω–∫—Ü–∏–π –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.

#### **C. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –∫–Ω–∏–≥–∏:**

1.  **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ (–≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö Flat File Connection Manager):**
    ```sql
    "C:\\Data\\Input_" + (DT_STR, 4, 1252) DATEPART("yyyy", GETDATE()) + "_" +
    RIGHT("0" + (DT_STR, 2, 1252) DATEPART("mm", GETDATE()), 2) + ".csv"
    ```
    *–†–µ–∑—É–ª—å—Ç–∞—Ç: `C:\Data\Input_2014_07.csv`*

2.  **–£—Å–ª–æ–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–≤ Precedence Constraint):**
    ```sql
    @[User::FileExists] == true && @[User::RecordCount] > 0
    ```
    *–°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –±–æ–ª—å—à–µ –Ω—É–ª—è.*

3.  **–í—ã—á–∏—Å–ª—è–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:**
    ```sql
    @[User::TomorrowDate] = DATEADD("day", 1, GETDATE())
    ```
    *–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `TomorrowDate` –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–∞—Ç—É –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–≥–æ –¥–Ω—è.*

4.  **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π SQL-–∑–∞–ø—Ä–æ—Å (–≤ Execute SQL Task):**
    ```sql
    "SELECT * FROM Sales WHERE SaleDate > '" + @[User::LastExtractDate] + "'"
    ```
    *–í–Ω–∏–º–∞–Ω–∏–µ! –†–∏—Å–∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏. –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.*

5.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ NULL (—Å –ø–æ–º–æ—â—å—é REPLACENULL –∏–ª–∏ —Ç–µ—Ä–Ω–∞—Ä–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞):**
    ```sql
    ISNULL(ColName) ? "Unknown" : ColName
    REPLACENULL(ColName, "Unknown")
    ```

---

### üéØ **–ß—Ç–æ –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –∏–∑ –ì–ª–∞–≤—ã 6:**

1.  **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:** **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã** ‚Äî –¥–ª—è –≤–Ω–µ—à–Ω–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** ‚Äî –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ª–æ–≥–∏–∫–∏, **–í—ã—Ä–∞–∂–µ–Ω–∏—è** ‚Äî –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π.
2.  **–û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (Scope)** ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–¥–∞ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.
3.  **–í—ã—Ä–∞–∂–µ–Ω–∏—è ‚Äî —ç—Ç–æ "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ" –≤ SSIS.** –° –∏—Ö –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–∞–∫–µ—Ç —É–º–Ω—ã–º –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º, –Ω–µ –ø—Ä–∏–±–µ–≥–∞—è –∫ Script Task.
4.  **–Ø–∑—ã–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –ø–æ—Ö–æ–∂ –Ω–∞ C#,** –Ω–æ —ç—Ç–æ –Ω–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π .NET. –ò–∑—É—á–∏—Ç–µ –µ–≥–æ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–æ–≤—ã–µ, –¥–ª—è –¥–∞—Ç, –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ, NULL-—Ñ—É–Ω–∫—Ü–∏–∏).
5.  **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ.** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Ç–∏–ø–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ Unicode) –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –¥–∞–Ω–Ω—ã—Ö.
6.  **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã (Sensitive)** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π, –Ω–æ –∏—Ö –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –≤ runtime.

---

### ‚ùì **–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–∑ —Ç–µ–º—ã –ì–ª–∞–≤—ã 6:**

*"–ö–∞–∫ –≤—ã –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç–µ –≤ –ø–∞–∫–µ—Ç–µ SSIS –æ–±—Ä–∞–±–æ—Ç–∫—É —Ñ–∞–π–ª–æ–≤, –∏–º–µ–Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Sales_20231027.csv`), –∏ –≤–∞–º –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π —Ñ–∞–π–ª?"*

**–ò–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö):**
1.  **–°–æ–∑–¥–∞–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é** `User::TodayFileName` —Ç–∏–ø–∞ String.
2.  **–ü—Ä–∏—Å–≤–æ—é –µ–π –≤—ã—Ä–∞–∂–µ–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏–º—è —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ —Ñ–∞–π–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞ –∏ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã:
    ```sql
    "C:\\Incoming\\Sales_" + (DT_STR, 4, 1252) YEAR(GETDATE()) +
    RIGHT("0" + (DT_STR, 2, 1252) MONTH(GETDATE()), 2) +
    RIGHT("0" + (DT_STR, 2, 1252) DAY(GETDATE()), 2) + ".csv"
    ```
3.  –í **Foreach Loop Container** (–∏–ª–∏ –ø–µ—Ä–µ–¥ File System Task) –¥–æ–±–∞–≤–ª—é **Script Task**, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ø–æ –ø—É—Ç–∏ –∏–∑ —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—à–µ—Ç –≤ –±—É–ª–µ–≤—Å–∫—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `User::FileExistsToday`.
4.  **Precedence Constraint** –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–≤—ã—Ä–∞–∂–µ–Ω–∏–µ** `@[User::FileExistsToday] == true`. –ï—Å–ª–∏ —Ñ–∞–π–ª –µ—Å—Ç—å ‚Äî –ø–æ—Ç–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø–∞–∫–µ—Ç –ø–µ—Ä–µ–π–¥—ë—Ç –∫ –¥—Ä—É–≥–∏–º –æ–ø–µ—Ä–∞—Ü–∏—è–º –∏–ª–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è.
5.  –í **Flat File Connection Manager** –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É —É–∫–∞–∂—É **Property Expression**, —Å—Å—ã–ª–∞—é—â–µ–µ—Å—è –Ω–∞ `@[User::TodayFileName]`.

*–≠—Ç–æ—Ç –æ—Ç–≤–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å–≤—è–∑–∫–∏ "–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–≤—ã—Ä–∞–∂–µ–Ω–∏—è-–ª–æ–≥–∏–∫–∞ –ø–æ—Ç–æ–∫–∞".*

---

### üîß **–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏–∑ –≥–ª–∞–≤—ã:**
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Parameter –≤–º–µ—Å—Ç–æ Variable**, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∏–∑–≤–Ω–µ.
- **–í—ã–Ω–æ—Å–∏—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏.
- **–ò–∑–±–µ–≥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤ Property Expressions** –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π ‚Äî –ª—É—á—à–µ –≤—ã—á–∏—Å–ª—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∞ –ø–æ—Ç–æ–º —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –Ω–µ—ë.
- **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è** –≤ Expression Builder, –∏—Å–ø–æ–ª—å–∑—É—è –∫–Ω–æ–ø–∫—É "Evaluate Expression".

---

‚úÖ **–ò—Ç–æ–≥ –ø–æ –ì–ª–∞–≤–µ 6:**
–≠—Ç–∞ –≥–ª–∞–≤–∞ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–Ω—ã–π –ø–∞–∫–µ—Ç SSIS –≤ **–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—É—é, –≥–∏–±–∫—É—é –∏ —É–ø—Ä–∞–≤–ª—è–µ–º—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É**. –í–ª–∞–¥–µ—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏, –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –∫ –æ–∫—Ä—É–∂–µ–Ω–∏—é, –¥–∞—Ç–∞–º, —Å–æ—Å—Ç–æ—è–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö –∏ –≤–Ω–µ—à–Ω–∏–º —Å–æ–±—ã—Ç–∏—è–º. –≠—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –Ω–∞–≤—ã–∫ –¥–ª—è senior-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ SSIS.
