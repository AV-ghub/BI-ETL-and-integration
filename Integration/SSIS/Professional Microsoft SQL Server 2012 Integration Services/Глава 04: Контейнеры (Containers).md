## **–ì–ª–∞–≤–∞ 4: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (Containers)**

–≠—Ç–∞ –≥–ª–∞–≤–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º** ‚Äî –æ–±—ä–µ–∫—Ç–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É—é—Ç –∑–∞–¥–∞—á–∏ –≤ Control Flow, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (—Ü–∏–∫–ª—ã) –∏ —É–ø—Ä–∞–≤–ª—è—é—Ç –æ–±–ª–∞—Å—Ç—å—é –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π. –≠—Ç–æ –∫–ª—é—á –∫ —Å–æ–∑–¥–∞–Ω–∏—é –º–æ–¥—É–ª—å–Ω—ã—Ö, –ø–æ–Ω—è—Ç–Ω—ã—Ö –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤.

---

### üìå **–í–∏–¥—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ SSIS:**

–í –≥–ª–∞–≤–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è 4 —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É):

---

#### **1. Task Host Container (–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –∑–∞–¥–∞—á–∏)**
- **"–ù–µ–≤–∏–¥–∏–º—ã–π" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.** –≠—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ Toolbox.
- **–ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞ –≤ SSIS –Ω–µ—è–≤–Ω–æ –ø–æ–º–µ—â–∞–µ—Ç—Å—è** –≤ —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π Task Host Container –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏.
- **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω?** –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ –µ—ë —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç: –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —Å–≤–æ–π—Å—Ç–≤–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, —Ç–æ—á–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥—á–∏–∫–æ–≤ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π.
- **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:** –û –Ω—ë–º –≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, –Ω–æ –Ω–µ –Ω—É–∂–Ω–æ "–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å". –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º.

**–î–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è:** *"Task Host ‚Äî —ç—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤ –∫–æ—Ç–æ—Ä—ã–π SSIS –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É. –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π —ç—Ç–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏."*

---

#### **2. Sequence Container (–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** **–õ–æ–≥–∏—á–µ—Å–∫–æ–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á.** –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–∞–±–æ—Ä –∑–∞–¥–∞—á –≤ –µ–¥–∏–Ω—ã–π –±–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Å–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤ –¥–∏–∑–∞–π–Ω–µ—Ä–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞.
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º:**
    - –í—Å–µ –∑–∞–¥–∞—á–∏ –≤–Ω—É—Ç—Ä–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ**, –≤ –ø–æ—Ä—è–¥–∫–µ, –∑–∞–¥–∞–Ω–Ω–æ–º Precedence Constraints.
    - –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (TransactionOption). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å –≤—Å—é –≥—Ä—É–ø–ø—É –∑–∞–¥–∞—á –∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏.
- **–û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ (Scope):** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ Sequence Container, –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ –∏ –≤ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏—Ö –∑–∞–¥–∞—á–∞—Ö. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏–º–µ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–¥–∞—á, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å **–æ—á–∏—Å—Ç–∫–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (staging)**.
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∑–∞–¥–∞—á **–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏** (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤, —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥-–∑–∞–ø–∏—Å–∏).
- –°–æ–∑–¥–∞–Ω–∏–µ **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å—Ç—Ä–æ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞).

---

#### **3. For Loop Container (–¶–∏–∫–ª "For")**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–¥–∞—á–∏ **–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑** (–∫–∞–∫ —Ü–∏–∫–ª `for` –≤ —è–∑—ã–∫–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è).
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç —Ç—Ä—ë—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π:**
    1.  **InitExpression:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π-—Å—á—ë—Ç—á–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@Counter = 0`).
    2.  **EvalExpression:** –£—Å–ª–æ–≤–∏–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ü–∏–∫–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@Counter < 10`).
    3.  **AssignExpression:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@Counter = @Counter + 1`).
- **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ `EvalExpression` **–ø–µ—Ä–µ–¥** –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π. –ï—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –ª–æ–∂–Ω–æ —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞, —Ü–∏–∫–ª –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –Ω–∏ —Ä–∞–∑—É.

**–ü—Ä–∏–º–µ—Ä –∏–∑ –∫–Ω–∏–≥–∏:** –ê–≤—Ç–æ—Ä—ã –æ–ø–∏—Å—ã–≤–∞—é—Ç –ª–æ–≥–∏–∫—É, –Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –Ω–µ—Ç. –¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Ä–æ–≤–Ω–æ N —Ä–∞–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3 –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–≤—Ç–æ—Ä–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–µ—Ç–∏).

---

#### **4. Foreach Loop Container (–¶–∏–∫–ª "Foreach") ‚Äî –û–ß–ï–ù–¨ –í–ê–ñ–ù–´–ô**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–¥–∞—á–∏ **–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏**. –≠—Ç–æ —Å–∞–º—ã–π —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (—Ñ–∞–π–ª–æ–≤, –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ, –∑–Ω–∞—á–µ–Ω–∏–π –∏ —Ç.–¥.).
- **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
    1.  **–ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ–ª—å (Enumerator)** –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∫–æ–ª–ª–µ–∫—Ü–∏–∏ (—Ñ–∞–π–ª—ã, –∑–∞–ø–∏—Å–∏ –ë–î, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ç.–¥.).
    2.  –ù–∞ **–∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏** —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ –∑–∞–¥–∞–Ω–Ω—É—é **–ø–µ—Ä–µ–º–µ–Ω–Ω—É—é SSIS**.
    3.  –ó–∞–¥–∞—á–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.

##### **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ–ª–µ–π (Foreach Enumerators):**
- **Foreach File Enumerator:** –ò—Ç–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —Ñ–∞–π–ª–∞–º –≤ –ø–∞–ø–∫–µ.
    - *–ü—Ä–∏–º–µ—Ä: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö `*.csv` —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ `C:\Incoming\`.*
- **Foreach ADO Enumerator:** –ò—Ç–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å—Ç—Ä–æ–∫–∞–º **–Ω–∞–±–æ—Ä–∞ –∑–∞–ø–∏—Å–µ–π ADO** (—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Execute SQL Task, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∏–ø–∞ `Object`).
    - *–ü—Ä–∏–º–µ—Ä: –î–ª—è –∫–∞–∂–¥–æ–≥–æ `CustomerID`, –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É.*
- **Foreach ADO.NET Schema Rowset Enumerator:** –ò—Ç–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å—Ö–µ–º–∞–º –ë–î (—Å–ø–∏—Å–∫–∏ —Ç–∞–±–ª–∏—Ü, —Å—Ç–æ–ª–±—Ü–æ–≤). –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–∫–µ—Ç–æ–≤.
- **Foreach From Variable Enumerator:** –ò—Ç–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏, —Ö—Ä–∞–Ω—è—â–µ–π—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–∞—Å—Å–∏–≤ –∑–Ω–∞—á–µ–Ω–∏–π).
- **Foreach NodeList Enumerator:** –ò—Ç–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —É–∑–ª–∞–º XML-–¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å –ø–æ–º–æ—â—å—é XPath-–≤—ã—Ä–∞–∂–µ–Ω–∏—è.
- **Foreach SMO Enumerator:** –ò—Ç–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ –æ–±—ä–µ–∫—Ç–∞–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è SQL Server (–±–∞–∑–∞–º, —Ç–∞–±–ª–∏—Ü–∞–º).

---

### üîß **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–Ω–∏–≥–∏**

#### **–ü—Ä–∏–º–µ—Ä A: Foreach File Enumerator**
**–°—Ü–µ–Ω–∞—Ä–∏–π:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –∑–∞–¥–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ.
1.  **Foreach Loop Container** –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —Å –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ–ª–µ–º **Foreach File Enumerator**.
2.  –£–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–∞–ø–∫–∞ –∏ –º–∞—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `*.txt`).
3.  –í —Å–≤–æ–π—Å—Ç–≤–∞—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∑–∞–¥–∞—ë—Ç—Å—è, —á—Ç–æ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ç–µ–∫—É—â–µ–º—É —Ñ–∞–π–ª—É –±—É–¥–µ—Ç –ø–æ–º–µ—â–∞—Ç—å—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `User::CurrentFileName`.
4.  **–í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è Data Flow Task.
5.  –í Source Data Flow (–Ω–∞–ø—Ä–∏–º–µ—Ä, Flat File Source) **–≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—ã—Ä–∞–∂–µ–Ω–∏–µ**, —Å—Å—ã–ª–∞—é—â–µ–µ—Å—è –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `@[User::CurrentFileName]`. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫ **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º**.
6.  –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª –º–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —Å –ø–æ–º–æ—â—å—é File System Task.

**–°—É—Ç—å:** –ü–∞–∫–µ—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–∞—Å–∫–µ.

#### **–ü—Ä–∏–º–µ—Ä B: Foreach ADO Enumerator**
**–°—Ü–µ–Ω–∞—Ä–∏–π:** –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏, –≤–æ–∑–≤—Ä–∞—â—ë–Ω–Ω–æ–π SQL-–∑–∞–ø—Ä–æ—Å–æ–º.
1.  **Execute SQL Task** **–¥–æ** —Ü–∏–∫–ª–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π **–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∑–∞–ø–∏—Å–µ–π (Full Result Set)**. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `User::CustomerList` —Ç–∏–ø–∞ `Object`.
2.  **Foreach Loop Container** –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —Å –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ–ª–µ–º **Foreach ADO Enumerator**.
3.  –í –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `User::CustomerList`.
4.  –ù–∞ –≤–∫–ª–∞–¥–∫–µ **Variable Mappings** –∑–∞–¥–∞—ë—Ç—Å—è, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∫–æ—Ä–¥—Å–µ—Ç–∞ –±—É–¥—É—Ç –ø–æ–º–µ—â–∞—Ç—å—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ SSIS (–Ω–∞–ø—Ä–∏–º–µ—Ä, `User::CurrentCustomerID`, `User::CurrentCustomerName`).
5.  **–í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** –∑–∞–¥–∞—á–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Execute SQL Task —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `WHERE CustomerID = ?`, –∫—É–¥–∞ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è `@[User::CurrentCustomerID]`).

**–°—É—Ç—å:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è **–ø–æ—Å—Ç—Ä–æ—á–Ω–æ–π (row-by-row) –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ Control Flow**, –∫–æ–≥–¥–∞ –æ–ø–µ—Ä–∞—Ü–∏—é –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∏–∑ –ë–î.

---

### üéØ **–ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –∏ –≤–∞–∂–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏–∑ –≥–ª–∞–≤—ã:**

| –ê—Å–ø–µ–∫—Ç | For Loop Container | Foreach Loop Container |
| :--- | :--- | :--- |
| **–û—Å–Ω–æ–≤–∞** | –°—á—ë—Ç—á–∏–∫ –∏ —É—Å–ª–æ–≤–∏–µ. | –ö–æ–ª–ª–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤. |
| **–ö–æ–Ω—Ç—Ä–æ–ª—å** | –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–¥–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ —Ä–∞–∑. | –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏. |
| **–¢–∏–ø–∏—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** | –ü–æ–≤—Ç–æ—Ä –ø–æ–ø—ã—Ç–∫–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤, –∏—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –∑–∞–ø–∏—Å—è–º –ë–î. |
| **–ì–∏–±–∫–æ—Å—Ç—å** | –ú–µ–Ω–µ–µ –≥–∏–±–∫–∏–π, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—á—ë—Ç—á–∏–∫–∞. | –û—á–µ–Ω—å –≥–∏–±–∫–∏–π, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏. |

**2. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã vs –ì—Ä—É–ø–ø—ã (Groups):**
- **–ì—Ä—É–ø–ø–∞** (–ø–æ–ª—É—á–µ–Ω–Ω–∞—è —á–µ—Ä–µ–∑ –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí Group) ‚Äî —ç—Ç–æ **—Ç–æ–ª—å–∫–æ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ** –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã –≤ –¥–∏–∑–∞–π–Ω–µ—Ä–µ. –û–Ω–∞ –Ω–µ –∏–º–µ–µ—Ç —Å–≤–æ–π—Å—Ç–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–ª–∏ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏.
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä** (–æ—Å–æ–±–µ–Ω–Ω–æ Sequence) ‚Äî —ç—Ç–æ **–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –æ–±—ä–µ–∫—Ç** —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –æ–±–ª–∞—Å—Ç—å—é –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

**3. –û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (Variable Scope):**
- –û–¥–Ω–∞ –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ ‚Äî **–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**.
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞–∫–µ—Ç–∞, –≤–∏–¥–Ω–∞ –≤–µ–∑–¥–µ.
- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –≤–Ω—É—Ç—Ä–∏ Sequence –∏–ª–∏ Loop Container, –≤–∏–¥–Ω–∞ **—Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –µ–≥–æ –¥–æ—á–µ—Ä–Ω–∏—Ö –∑–∞–¥–∞—á**. –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã.

---

### ‚ùì **–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–∑ —Ç–µ–º—ã –ì–ª–∞–≤—ã 4:**

*"–ö–∞–∫ –≤—ã –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É 100 —Ñ–∞–π–ª–æ–≤, –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –ø—Ä–∏—Ö–æ–¥—è—â–∏—Ö –≤ –ø–∞–ø–∫—É, –≤ –æ–¥–Ω–æ–º –ø–∞–∫–µ—Ç–µ SSIS?"*

**–ò–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤):**
1.  –Ø –∏—Å–ø–æ–ª—å–∑—É—é **Foreach Loop Container** —Å –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ–ª–µ–º **Foreach File Enumerator**.
2.  –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é –µ–≥–æ –Ω–∞ –ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –ø–æ –Ω—É–∂–Ω–æ–π –º–∞—Å–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `*.dat`) –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ.
3.  –ù–∞–∑–Ω–∞—á–∞—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `FileName`), –≤ –∫–æ—Ç–æ—Ä—É—é –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –±—É–¥–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ç–µ–∫—É—â–µ–º—É —Ñ–∞–π–ª—É.
4.  **–í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** —Ä–∞–∑–º–µ—â–∞—é:
    *   **Data Flow Task**, –≥–¥–µ –∏—Å—Ç–æ—á–Ω–∏–∫ (Flat File Source) –≤ –∫–∞—á–µ—Å—Ç–≤–µ ConnectionString –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≤—ã—Ä–∞–∂–µ–Ω–∏–µ**, —Å—Å—ã–ª–∞—é—â–µ–µ—Å—è –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `@[User::FileName]`.
    *   **File System Task** (–ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏) –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫—É `Archive`.
5.  –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏—Ç **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—É—é** –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –ø–∞–∫–µ—Ç–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã, –Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Ü–∏–∫–ª.

---

### üõ† **–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏–∑ –≥–ª–∞–≤—ã:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Sequence Container** –¥–ª—è –ª–æ–≥–∏—á–µ—Å–∫–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.
- –î–ª—è –º–∞—Å—Å–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤—Å–µ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–π—Ç–µ **Foreach Loop Container** –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è 100 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–∞–¥–∞—á.
- –ü–æ–º–Ω–∏—Ç–µ –æ–± **–æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö** –ø—Ä–∏ –∏—Ö —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.
- **Foreach ADO Enumerator** ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏ Control Flow, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î.

---

‚úÖ **–ò—Ç–æ–≥ –ø–æ –ì–ª–∞–≤–µ 4:**
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç SSIS –∏–∑ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–¥–∞—á –≤ **–º–æ—â–Ω—É—é —Å—Ä–µ–¥—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö, —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã–º–∏ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**
