–≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞—è –≥–ª–∞–≤–∞, –∫–æ—Ç–æ—Ä–∞—è —É—á–∏—Ç **–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ä–∞–±–æ—Ç—É –º–µ–∂–¥—É SSIS –∏ SQL Server**. –ì–ª–∞–≤–Ω—ã–π –µ—ë –ø–æ—Å—ã–ª: **–ù–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å —Å–¥–µ–ª–∞—Ç—å –≤—Å—ë –≤ SSIS, –µ—Å–ª–∏ —Ç—É –∂–µ —Ä–∞–±–æ—Ç—É –º–æ–∂–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –º–æ—â–Ω–æ–≥–æ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞ SQL Server**.

---

## **–ì–ª–∞–≤–∞ 12: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞ (Using the Relational Engine)**

–≠—Ç–∞ –≥–ª–∞–≤–∞ ‚Äî –º–∞–Ω–∏—Ñ–µ—Å—Ç **–ø—Ä–∞–≥–º–∞—Ç–∏—á–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ ETL**. –ê–≤—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –ø–µ—Ä–µ–Ω–æ—Å –∫–ª—é—á–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –∞–≥—Ä–µ–≥–∞—Ü–∏—è, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ) –Ω–∞ —É—Ä–æ–≤–µ–Ω—å SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–∂–µ—Ç —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —É–ø—Ä–æ—Å—Ç–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ —Å–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ø–∞–º—è—Ç—å SSIS.

---

### üìå **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –≥–ª–∞–≤—ã:**

1.  **–ò–∑–≤–ª–µ–∫–∞–π—Ç–µ –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö (Extract Less).**
2.  **–§–∏–ª—å—Ç—Ä—É–π—Ç–µ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ (Filter and Transform at Source).**
3.  **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ SQL (Use Set-Based Logic).**
4.  **–ó–∞–¥–µ–π—Å—Ç–≤—É–π—Ç–µ –º–æ—â–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ SQL Server (CDC, MERGE, Snapshots).**

---

### **1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (Data Extraction)**

#### **A. SELECT * ‚Äî —ç—Ç–æ –ø–ª–æ—Ö–æ (SELECT * Is Bad)**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, –¥–∞–∂–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–±—ä—ë–º –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–æ–≤ –≤ –ø–∞–º—è—Ç–∏ SSIS –∏ —Å–Ω–∏–∂–∞–µ—Ç –æ–±—â—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
- **–†–µ—à–µ–Ω–∏–µ:** –í Source Component –≤—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ **—è–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤**. –≠—Ç–æ –¥–∞—ë—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à.

#### **B. WHERE ‚Äî –≤–∞—à –¥—Ä—É–≥ (WHERE Is Your Friend)**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –≤ OLE DB Source –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.
    *   *–ü—Ä–∏–º–µ—Ä:* `SELECT * FROM Sales WHERE SaleDate > ?`
    *   –ü–∞—Ä–∞–º–µ—Ç—Ä (`?`) –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π SSIS (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@[User::LastExtractDate]`).
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í SSIS –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.

#### **C. –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –≤–æ –≤—Ä–µ–º—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è (Transform during Extract)**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–≥—Ä—É–∑–∫–∞ "—Å—ã—Ä—ã—Ö" –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö —Å–ª–æ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ Data Flow (—á–µ—Ä–µ–∑ Derived Column, Data Conversion).
- **–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (–ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –ø—Ä–æ—Å—Ç—ã–µ CASE) –ø—Ä—è–º–æ –≤ **SQL-–∑–∞–ø—Ä–æ—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞**.
    *   *–ü—Ä–∏–º–µ—Ä –≤ –∫–Ω–∏–≥–µ:* –í–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ `FirstName` –∏ `LastName` —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –≤ Derived Column, –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É –≤–µ—Ä–Ω—É—Ç—å `FullName`:
        ```sql
        SELECT CustomerID, FirstName + ' ' + LastName AS FullName FROM Customers
        ```
- **–í—ã–≥–æ–¥–∞:** –£–ø—Ä–æ—â–∞–µ—Ç—Å—è Data Flow, —Å–Ω–∏–∂–∞–µ—Ç—Å—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ø–∞–º—è—Ç—å SSIS, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –°–£–ë–î.

#### **D. –°–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (SORT in the Database)**
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è **Sort Transformation** –≤ SSIS –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö.
- **–†–µ—à–µ–Ω–∏–µ:** –ï—Å–ª–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω—É–∂–Ω–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ **Merge Join**, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –µ—ë —Å –ø–æ–º–æ—â—å—é `ORDER BY` –≤ –∑–∞–ø—Ä–æ—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.
    *   *–í–∞–∂–Ω–æ:* –î–ª—è —ç—Ç–æ–≥–æ –≤ OLE DB Source –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ **AccessMode** = `SQL Command` –∏ –≤ –æ–ø—Ü–∏—è—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤—ã–±—Ä–∞—Ç—å **"SQL command is ordered by"**.
- **–í—ã–≥–æ–¥–∞:** –ò–∑–±–µ–≥–∞–µ–º –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ –ø–∞–º—è—Ç–∏ SSIS.

#### **E. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ set-based –ª–æ–≥–∏–∫—É (Using Set-Based Logic)**
- **–ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø ETL:** **–û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ (set-based) –≤—Å–µ–≥–¥–∞ –±—ã—Å—Ç—Ä–µ–µ –ø–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö (row-by-row) –æ–ø–µ—Ä–∞—Ü–∏–π.**
- **–ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω:** OLE DB Command Transformation, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏.
- **–†–µ—à–µ–Ω–∏–µ:** –ù–∞–ø—Ä–∞–≤–ª—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ, —Ç—Ä–µ–±—É—é—â–∏–µ —Å–ª–æ–∂–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —É–¥–∞–ª–µ–Ω–∏—è), –≤–æ **–≤—Ä–µ–º–µ–Ω–Ω—É—é (staging) —Ç–∞–±–ª–∏—Ü—É**, –∞ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –µ–¥–∏–Ω—ã–π `UPDATE`, `MERGE` –∏–ª–∏ `DELETE` —Å –ø–æ–º–æ—â—å—é **Execute SQL Task**.

---

### **2. Change Data Capture (CDC) –≤ SQL Server**
- **CDC** ‚Äî —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è SQL Server, –∫–æ—Ç–æ—Ä–∞—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è** (INSERT, UPDATE, DELETE) –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö, –∑–∞–ø–∏—Å—ã–≤–∞—è –∏—Ö –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã-–∂—É—Ä–Ω–∞–ª—ã.
- **–ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ—Ç:** –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è **–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** –±–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤, –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –∏–ª–∏ –ø–æ–ª–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.

#### **A. –ù–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã SSIS –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å CDC (Enterprise Edition):**
1.  **CDC Control Task (–≤ Control Flow):** –£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–µ—Å—Å–∏–∏ CDC (–æ—Ç–º–µ—á–∞–µ—Ç –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ).
2.  **CDC Source (–≤ Data Flow):** –ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü CDC –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–º–µ—Ç–∫–æ–π –æ–± –æ–ø–µ—Ä–∞—Ü–∏–∏ (`__$operation`): 1=—É–¥–∞–ª–µ–Ω–æ, 2=–≤—Å—Ç–∞–≤–ª–µ–Ω–æ, 4=–æ–±–Ω–æ–≤–ª–µ–Ω–æ.
3.  **CDC Splitter Transformation:** –†–∞–∑–¥–µ–ª—è–µ—Ç –ø–æ—Ç–æ–∫ –æ—Ç CDC Source –Ω–∞ —Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞: –¥–ª—è –≤—Å—Ç–∞–≤–æ–∫, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏ —É–¥–∞–ª–µ–Ω–∏–π.
4.  –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ **Destinations** –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

#### **B. –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CDC –≤ SSIS:**
1.  **CDC Control Task (Mark Load Start)** –æ—Ç–º–µ—á–∞–µ—Ç –Ω–∞—á–∞–ª–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (`@[User::CDC_State]`).
2.  **Data Flow Task:**
    *   –ò—Å—Ç–æ—á–Ω–∏–∫: **CDC Source** —á–∏—Ç–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª.
    *   **CDC Splitter** —Ä–∞–∑–¥–µ–ª—è–µ—Ç –ø–æ—Ç–æ–∫.
    *   –ü–æ—Ç–æ–∫ **–≤—Å—Ç–∞–≤–æ–∫** ‚Üí OLE DB Destination.
    *   –ü–æ—Ç–æ–∫ **–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π** ‚Üí (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OLE DB Command, –Ω–æ –ª—É—á—à–µ Staging + UPDATE).
    *   –ü–æ—Ç–æ–∫ **—É–¥–∞–ª–µ–Ω–∏–π** ‚Üí (Staging + DELETE).
3.  **CDC Control Task (Mark Load End)** —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —É—Å–ø–µ—à–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.

**–î–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è:** *"–î–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —è –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Change Data Capture, –µ—Å–ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äî SQL Server Enterprise Edition. –≠—Ç–æ –¥–∞—ë—Ç –Ω–∞–¥—ë–∂–Ω—ã–π –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –í SSIS –¥–ª—è —ç—Ç–æ–≥–æ –µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã CDC."*

---

### **3. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (Data Loading)**

#### **A. Database Snapshots (–ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–Ω–∏–º–∫–∏ –ë–î)**
- **–ú–µ—Ö–∞–Ω–∏–∫–∞:** –°–æ–∑–¥–∞–Ω–∏–µ read-only, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–ø–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏.
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ ETL:** –ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∏–ª–∏ —Ä–∞–∑—Ä—É—à–∞—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–Ω–∏–º–∫—É, –ø–æ–∫–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:** **–¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ** –∏ –º–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –ß–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è, —á–µ–º –¥–ª—è ETL.

#### **B. –û–ø–µ—Ä–∞—Ç–æ—Ä MERGE (The MERGE Operator)**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç—å **INSERT, UPDATE –∏–ª–∏ DELETE –≤ –æ–¥–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ —Å —Ü–µ–ª–µ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ–π.
- **–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è:** –ó–∞–≥—Ä—É–∑–∫–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π (SCD Type 1) –∏–ª–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–∫—Ç–æ–≤.
- **–ü—Ä–∏–º–µ—Ä –∏–∑ –∫–Ω–∏–≥–∏ (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π):**
    ```sql
    MERGE DimCustomer AS target
    USING Staging_Customer AS source
    ON (target.CustomerBusinessKey = source.CustomerID)
    WHEN MATCHED AND (target.CustomerName <> source.CustomerName) THEN
        UPDATE SET target.CustomerName = source.CustomerName
    WHEN NOT MATCHED THEN
        INSERT (CustomerBusinessKey, CustomerName) VALUES (source.CustomerID, source.CustomerName);
    ```
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ SSIS:** –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **Execute SQL Task** –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ staging-—Ç–∞–±–ª–∏—Ü—É.
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** –ß–∏—Å—Ç–∞—è, –∞—Ç–æ–º–∞—Ä–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è. –ß–∞—Å—Ç–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–µ INSERT/UPDATE.

---

### üéØ **–ß—Ç–æ –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –∏–∑ –ì–ª–∞–≤—ã 12:**

1.  **–§–∏–ª–æ—Å–æ—Ñ–∏—è: "–¢–æ–ª—Å—Ç—ã–π –∑–∞–ø—Ä–æ—Å, —Ç–æ–Ω–∫–∏–π Data Flow".** –ú–∞–∫—Å–∏–º—É–º –ª–æ–≥–∏–∫–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç–µ –≤ SQL-–∑–∞–ø—Ä–æ—Å—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
2.  **–ò–∑–±–µ–≥–∞–π—Ç–µ SELECT *** –∏ **–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ WHERE** –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö.
3.  **–°–æ—Ä—Ç–∏—Ä—É–π—Ç–µ (`ORDER BY`) –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ**, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –≤ SSIS.
4.  **CDC ‚Äî –º–æ—â–Ω–µ–π—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ SQL Server. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã SSIS –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º.
5.  **–û–ø–µ—Ä–∞—Ç–æ—Ä MERGE ‚Äî —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π UPSERT (–≤—Å—Ç–∞–≤–∫–∞ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ). –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –µ–≥–æ —á–µ—Ä–µ–∑ Execute SQL Task.
6.  **OLE DB Command ‚Äî –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω.** –ó–∞–º–µ–Ω—è–π—Ç–µ –µ–≥–æ –Ω–∞ Staging + set-based –æ–ø–µ—Ä–∞—Ü–∏—é.
7.  **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ staging-—Ç–∞–±–ª–∏—Ü—ã** –∫–∞–∫ –±—É—Ñ–µ—Ä –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ —Ç–æ—á–∫—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

---

### ‚ùì **–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–∑ —Ç–µ–º—ã –ì–ª–∞–≤—ã 12:**

*"–£ –≤–∞—Å –µ—Å—Ç—å –±–æ–ª—å—à–∞—è —Ç–∞–±–ª–∏—Ü–∞-–∏—Å—Ç–æ—á–Ω–∏–∫ (100 –º–ª–Ω —Å—Ç—Ä–æ–∫). –í–∞–º –Ω—É–∂–Ω–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤ DWH —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π. –ö–∞–∫ –≤—ã –ø–æ—Å—Ç—Ä–æ–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å?"*

**–ò–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (—Å–∏–Ω—Ç–µ–∑ –∑–Ω–∞–Ω–∏–π –≥–ª–∞–≤—ã):**
*"–Ø —Ä–∞—Å—Å–º–æ—Ç—Ä—é –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏—Å—Ç–æ—á–Ω–∏–∫–∞:*
1.  **–ò–¥–µ–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –µ—Å–ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äî SQL Server Enterprise Edition:** –í–∫–ª—é—á—É **Change Data Capture (CDC)** –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ-–∏—Å—Ç–æ—á–Ω–∏–∫–µ. –ó–∞—Ç–µ–º –≤ SSIS –∏—Å–ø–æ–ª—å–∑—É—é **CDC Source** –≤ Data Flow –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫. –≠—Ç–æ —Å–∞–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏–π –ø–æ–ª–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
2.  **–ï—Å–ª–∏ CDC –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:** –í OLE DB Source –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å `WHERE ModifiedDate >= ?`, –≥–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, —Ö—Ä–∞–Ω—è—â–µ–π –¥–∞—Ç—É –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–≥—Ä—É–∑–∫–∏. **–ö—Ä–∞–π–Ω–µ –≤–∞–∂–Ω–æ**, —á—Ç–æ–±—ã –≤ —Ç–∞–±–ª–∏—Ü–µ-–∏—Å—Ç–æ—á–Ω–∏–∫–µ –±—ã–ª –∏–Ω–¥–µ–∫—Å –ø–æ `ModifiedDate` –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏.
3.  **–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ DWH:** –î–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏–π (SCD) ‚Äî –∑–∞–≥—Ä—É–∂—É –æ—Ç–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ staging, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—é **–æ–ø–µ—Ä–∞—Ç–æ—Ä MERGE** —á–µ—Ä–µ–∑ Execute SQL Task. –î–ª—è —Ñ–∞–∫—Ç–æ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ `INSERT` —Å –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π —á–µ—Ä–µ–∑ Lookup.
*–ö–ª—é—á–µ–≤–æ–µ ‚Äî –Ω–µ –≤—ã–≥—Ä—É–∂–∞—Ç—å 100 –º–ª–Ω —Å—Ç—Ä–æ–∫ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∞ –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–µ–ª—å—Ç—É, –∏—Å–ø–æ–ª—å–∑—É—è –ª–∏–±–æ CDC, –ª–∏–±–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ø–æ–ª—é."*

---

‚úÖ **–ò—Ç–æ–≥ –ø–æ –ì–ª–∞–≤–µ 12:**
–≠—Ç–∞ –≥–ª–∞–≤–∞ **—É—á–∏—Ç –¥—É–º–∞—Ç—å –∫–∞–∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä, –∞ –Ω–µ –∫–∞–∫ "–∫–ª–∏–∫–∞—Ç–µ–ª—å" –≤ –¥–∏–∑–∞–π–Ω–µ—Ä–µ SSIS**. –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ **–≤—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ë–î vs SSIS) —á–∞—Å—Ç–æ –≤–∞–∂–Ω–µ–µ, —á–µ–º –≤—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ SSIS**. –ù–∞–∏–ª—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏ **—Å–∏–º–±–∏–æ–∑–µ SSIS –∏ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞**, –≥–¥–µ –∫–∞–∂–¥—ã–π –¥–µ–ª–∞–µ—Ç —Ç–æ, —á—Ç–æ —É–º–µ–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ.
