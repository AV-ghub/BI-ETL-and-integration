–ï—Å–ª–∏ –ì–ª–∞–≤–∞ 18 –Ω–∞—É—á–∏–ª–∞ –Ω–∞—Å —Å–æ–∑–¥–∞–≤–∞—Ç—å "–¥–≤–∏–∂–æ–∫" –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —Ç–æ —ç—Ç–∞ –≥–ª–∞–≤–∞ —É—á–∏—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–ª—è –Ω–µ–≥–æ **—É–¥–æ–±–Ω—ã–π, –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –≤ SSDT, —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ —É —à—Ç–∞—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (—Å –≤–∫–ª–∞–¥–∫–∞–º–∏, –∫–Ω–æ–ø–∫–∞–º–∏ –∏ –¥–∏–∞–ª–æ–≥–∞–º–∏).

---

## **–ì–ª–∞–≤–∞ 19: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫ –≤–∞—à–µ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É**

–≠—Ç–∞ –≥–ª–∞–≤–∞ ‚Äî —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (UI) –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (design-time UI)** –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ SSIS. –•–æ—Ä–æ—à–∏–π UI –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º, –ª—ë–≥–∫–∏–º –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏ —Å–Ω–∏–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –µ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

---

### üìå **–¢—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö —à–∞–≥–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è UI (–æ–±–∑–æ—Ä):**

1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è UI** (–æ–±—ã—á–Ω–æ Windows Forms –∏–ª–∏ WPF).
2.  **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `IDtsComponentUI`** –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–ª–∞—Å—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.
3.  **–°–≤—è–∑—ã–≤–∞–Ω–∏–µ UI —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º** —á–µ—Ä–µ–∑ –∞—Ç—Ä–∏–±—É—Ç `UITypeName`.

---

### **1. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (Building the User Interface)**

#### **A. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (Adding the Project)**
- –ö–∞—Å—Ç–æ–º–Ω—ã–π UI –æ–±—ã—á–Ω–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ **–æ—Ç–¥–µ–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ** (Class Library) –≤–Ω—É—Ç—Ä–∏ —Ç–æ–≥–æ –∂–µ —Ä–µ—à–µ–Ω–∏—è, —á—Ç–æ –∏ —Å–∞–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.
- –¢–∏–ø –ø—Ä–æ–µ–∫—Ç–∞: **Windows Forms Class Library** –∏–ª–∏ **WPF Custom Control Library**.
- **–í–∞–∂–Ω–æ:** –°–±–æ—Ä–∫–∞ UI –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–ø–æ–¥–ø–∏—Å–∞–Ω–∞ —Å—Ç—Ä–æ–≥–∏–º –∏–º–µ–Ω–µ–º (strong-named)** –∏ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–∞ –≤ **GAC**, –∫–∞–∫ –∏ –æ—Å–Ω–æ–≤–Ω–∞—è —Å–±–æ—Ä–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

#### **B. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `IDtsComponentUI`**
- –ß—Ç–æ–±—ã SSIS –∑–Ω–∞–ª, –∫–∞–∫–æ–π UI –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–Ω–∞—Å–ª–µ–¥–Ω–∏–∫ `PipelineComponent`) –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å **`Microsoft.SqlServer.Dts.Pipeline.Design.IDtsComponentUI`**.
- –≠—Ç–æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–¥–µ—Ä–∂–∏—Ç **–≤—Å–µ–≥–æ –æ–¥–∏–Ω –∫–ª—é—á–µ–≤–æ–π –º–µ—Ç–æ–¥**:
    ```csharp
    void Edit(IWin32Window parentWindow, IServiceProvider serviceProvider, IDTSComponentMetaData100 componentMetadata);
    ```
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ `Edit`:** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–¥–≤–∞–∂–¥—ã —â—ë–ª–∫–∞–µ—Ç** –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –≤ –¥–∏–∑–∞–π–Ω–µ—Ä–µ Data Flow. –í —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è:
    - `parentWindow`: –•—ç–Ω–¥–ª –æ–∫–Ω–∞-—Ä–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞.
    - `serviceProvider`: –î–æ—Å—Ç—É–ø –∫ —Å–ª—É–∂–±–∞–º SSDT (–æ—á–µ–Ω—å –≤–∞–∂–Ω–æ!).
    - `componentMetadata`: **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞** ‚Äî —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç UI –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –≤—Ö–æ–¥—ã, –≤—ã—Ö–æ–¥—ã, –∫–æ–ª–æ–Ω–∫–∏.

#### **C. –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `Edit`**
```csharp
public void Edit(System.Windows.Forms.IWin32Window parentWindow, IServiceProvider serviceProvider, IDTSComponentMetaData100 componentMetadata)
{
    // 1. –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—à–µ–π —Ñ–æ—Ä–º—ã UI
    MyComponentEditorForm editorForm = new MyComponentEditorForm();
    
    // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ–æ—Ä–º—É, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–π –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ serviceProvider
    editorForm.Initialize(componentMetadata, serviceProvider);
    
    // 3. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –∫–∞–∫ –º–æ–¥–∞–ª—å–Ω—ã–π –¥–∏–∞–ª–æ–≥
    if (editorForm.ShowDialog(parentWindow) == DialogResult.OK)
    {
        // 4. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª OK, –ø—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ —Ñ–æ—Ä–º—ã –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É
        // (–û–±—ã—á–Ω–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Å–∞–º–æ–π —Ñ–æ—Ä–º—ã –≤ –º–æ–º–µ–Ω—Ç –Ω–∞–∂–∞—Ç–∏—è OK)
    }
}
```

#### **D. –£–∫–∞–∑–∞–Ω–∏–µ `UITypeName` (Setting the UITypeName)**
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –ù—É–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å SSIS, –∫–∞–∫–æ–π –∫–ª–∞—Å—Å —Å–æ–¥–µ—Ä–∂–∏—Ç UI.
- –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ –º–µ—Ç–æ–¥–µ **`ProvideComponentProperties()`** –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
    ```csharp
    public override void ProvideComponentProperties()
    {
        // ... –±–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ ...
        
        // –£–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–Ω–æ–µ –∏–º—è —Ç–∏–ø–∞ (assembly-qualified name) –∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç IDtsComponentUI.
        // –û–±—ã—á–Ω–æ —ç—Ç–æ —Å–∞–º –∂–µ –∫–ª–∞—Å—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.
        ComponentMetaData.UITypeName = typeof(MyCustomComponent).AssemblyQualifiedName;
    }
```
- `AssemblyQualifiedName` –≤–∫–ª—é—á–∞–µ—Ç –∏–º—è —Å–±–æ—Ä–∫–∏, –≤–µ—Ä—Å–∏—é, –∫—É–ª—å—Ç—É—Ä—É –∏ —Ç–æ–∫–µ–Ω –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫–ª—é—á–∞. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ SSIS –Ω–∞–π–¥—ë—Ç –Ω—É–∂–Ω—É—é —Å–±–æ—Ä–∫—É –≤ GAC.

---

### **2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (Extending the User Interface)**

–ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ ‚Äî —ç—Ç–æ –Ω–∞—á–∞–ª–æ. –ù–∞—Å—Ç–æ—è—â–∏–π –º–æ—â–Ω—ã–π UI –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å–æ —Å—Ä–µ–¥–æ–π SSDT.

#### **A. –î–∏—Å–ø–µ—Ç—á–µ—Ä—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (Runtime Connections)**
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å Connection Manager (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏–ª–∏ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î).
- –í UI –º–æ–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é **–≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö Connection Managers** –ø—Ä–æ–µ–∫—Ç–∞ –Ω—É–∂–Ω–æ–≥–æ —Ç–∏–ø–∞.
- **–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫:** –ß–µ—Ä–µ–∑ `serviceProvider` –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å `IDtsConnectionService`.
    ```csharp
    IDtsConnectionService connectionService = (IDtsConnectionService)serviceProvider.GetService(typeof(IDtsConnectionService));
    // –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Ç–∏–ø–∞ FILE
    ConnectionManagerInfos infos = connectionService.GetConnectionManagerInfos(new Guid("{DTS.ConnectionManagerType.FILE}"));
    ```

#### **B. –°–≤–æ–π—Å—Ç–≤–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (Component Properties)**
- –í—Å–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `FileName`, `Delimiter`) —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö (Custom Properties)** –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `ComponentMetaData.CustomPropertyCollection`.
- –ó–∞–¥–∞—á–∞ UI:
    1.  **–ü—Ä–æ—á–∏—Ç–∞—Ç—å** —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –∏–∑ `componentMetadata` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ä–º—ã.
    2.  **–ó–∞–ø–∏—Å–∞—Ç—å** –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ –≤ `componentMetadata` –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ (OK).
- **–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤—ã–∑–≤–∞—Ç—å `ReinitializeMetaData()`, —á—Ç–æ–±—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª —Å–≤–æ–∏ –≤—ã—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏.

#### **C. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (Handling Errors and Warnings)**
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤—ë–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ UI (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—É—Ç—å), –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–∫–Ω–æ –æ—à–∏–±–∫–∏ SSIS**.
- –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å `IErrorCollectionService`:
    ```csharp
    IErrorCollectionService errorService = (IErrorCollectionService)serviceProvider.GetService(typeof(IErrorCollectionService));
    errorService.AddError(0, "MyComponent", "–£–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.", "", 0);
    ```

#### **D. –°–≤–æ–π—Å—Ç–≤–∞ –∫–æ–ª–æ–Ω–æ–∫ (Column Properties)**
- –î–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π (Transformations) UI –º–æ–∂–µ—Ç –ø–æ–∑–≤–æ–ª—è—Ç—å –≤—ã–±–∏—Ä–∞—Ç—å, **–∫–∞–∫–∏–µ –≤—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ **–∫–∞–∫–∏–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏** —Å–æ–∑–¥–∞–≤–∞—Ç—å.
- –î–æ—Å—Ç—É–ø –∫ –∫–æ–ª–æ–Ω–∫–∞–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑:
    - `componentMetadata.InputCollection[0].InputColumnCollection` ‚Äî –¥–ª—è –≤—Ö–æ–¥–∞.
    - `componentMetadata.OutputCollection[0].OutputColumnCollection` ‚Äî –¥–ª—è –≤—ã—Ö–æ–¥–∞.
- UI –º–æ–∂–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–ø–∏—Å–∫–∏ –∫–æ–ª–æ–Ω–æ–∫, –ø–æ–∑–≤–æ–ª—è—Ç—å –≤—ã–±–∏—Ä–∞—Ç—å –∏—Ö –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ (–∏–º—è, —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö).

---

### **3. –ü—Ä–æ—á–∏–µ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ UI (Other UI Considerations)**
- **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (Localization):** –ï—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö, –∑–∞–ª–æ–∂–∏—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫ –≤ UI.
- **–û—Ç–º–µ–Ω–∞ (Cancellation):** –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É **Cancel** –≤ —Ñ–æ—Ä–º–µ. –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è.
- **–í–∞–ª–∏–¥–∞—Ü–∏—è (Validation):** –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ *–¥–æ* –∑–∞–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã —Å OK. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ErrorProvider` –≤ WinForms –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ü–∏–∏ –æ—à–∏–±–æ–∫.
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ù–µ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–µ–Ω–∏–µ huge file –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞) –≤ UI-–ø–æ—Ç–æ–∫–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ background threads.

---

### üéØ **–ß—Ç–æ –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –∏–∑ –ì–ª–∞–≤—ã 19:**

1.  **–ö–∞—Å—Ç–æ–º–Ω—ã–π UI ‚Äî —ç—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ.** –û–Ω —Ä–µ–∑–∫–æ —Å–Ω–∏–∂–∞–µ—Ç –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ —É–º–µ–Ω—å—à–∞–µ—Ç –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
2.  **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IDtsComponentUI` –∏ –º–µ—Ç–æ–¥ `Edit` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞.** SSIS –≤—ã–∑—ã–≤–∞–µ—Ç `Edit` –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —â–µ–ª—á–∫–µ –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ.
3.  **`UITypeName` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–¥–∞–Ω.** –ë–µ–∑ —ç—Ç–æ–≥–æ SSIS –Ω–µ –Ω–∞–π–¥—ë—Ç –≤–∞—à UI –∏ –æ—Ç–∫—Ä–æ–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π (–ø—É—Å—Ç–æ–π) —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–≤–æ–π—Å—Ç–≤.
4.  **`IServiceProvider` ‚Äî –∫–ª—é—á –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.** –ß–µ—Ä–µ–∑ –Ω–µ–≥–æ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ Connection Managers, —Å–µ—Ä–≤–∏—Å–∞–º –æ—à–∏–±–æ–∫ –∏ –¥—Ä—É–≥–∏–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º SSDT.
5.  **`IDTSComponentMetaData100` ‚Äî —ç—Ç–æ "–∂–∏–≤–æ–π" –æ–±—ä–µ–∫—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.** –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ UI –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –∫ –Ω–µ–º—É.
6.  **UI –¥–æ–ª–∂–µ–Ω –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤–≤–æ–¥** –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç–º–µ–Ω—É.

---

### ‚ùì **–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–∑ —Ç–µ–º—ã –ì–ª–∞–≤—ã 19:**

*"–í—ã —Å–æ–∑–¥–∞–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç-–∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è —á—Ç–µ–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –ª–æ–≥–æ–≤. –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥–ª–∏ —É–¥–æ–±–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø—É—Ç—å –∫ –ª–æ–≥-—Ñ–∞–π–ª—É –∏ –≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–¥–∏—Ä–æ–≤–∫—É —á–µ—Ä–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∞ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—è XML?"*

**–†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç (–ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω):**
1.  **–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç UI:** –î–æ–±–∞–≤–∏—Ç—å –≤ —Ä–µ—à–µ–Ω–∏–µ Windows Forms –ø—Ä–æ–µ–∫—Ç, —Å–æ–∑–¥–∞—Ç—å —Ñ–æ—Ä–º—É (`LogSourceEditorForm`).
2.  **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `IDtsComponentUI`:** –í –æ—Å–Ω–æ–≤–Ω–æ–º –∫–ª–∞—Å—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (`CustomLogSource`) —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –º–µ—Ç–æ–¥ `Edit`. –í —ç—Ç–æ–º –º–µ—Ç–æ–¥–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä `LogSourceEditorForm`, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–∫ –¥–∏–∞–ª–æ–≥.
3.  **–ó–∞–¥–∞—Ç—å `UITypeName`:** –í `ProvideComponentProperties()` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `ComponentMetaData.UITypeName = typeof(CustomLogSource).AssemblyQualifiedName`.
4.  **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É:**
    *   **–ü–æ–ª–µ "–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É":** `TextBox` + –∫–Ω–æ–ø–∫–∞ "–û–±–∑–æ—Ä..." (`OpenFileDialog`).
    *   **–í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ "–ö–æ–¥–∏—Ä–æ–≤–∫–∞":** `ComboBox` —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ (UTF-8, Windows-1251, etc.).
    *   –ö–Ω–æ–ø–∫–∏ **OK** –∏ **Cancel**.
5.  **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ä–µ–¥–æ–π SSDT –≤ —Ñ–æ—Ä–º–µ:**
    *   –í –º–µ—Ç–æ–¥ `Initialize` —Ñ–æ—Ä–º—ã –ø—Ä–∏–Ω–∏–º–∞—Ç—å `IDTSComponentMetaData100` –∏ `IServiceProvider`.
    *   **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:** –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ `FileName` –∏ `Encoding` –∏–∑ `componentMetadata.CustomPropertyCollection` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö –≤ –∫–æ–Ω—Ç—Ä–æ–ª—ã —Ñ–æ—Ä–º—ã.
    *   **–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ OK:**
        - **–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª.
        - **–ó–∞–ø–∏—Å–∞—Ç—å:** –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –æ–±—Ä–∞—Ç–Ω–æ –≤ `componentMetadata.CustomPropertyCollection`.
        - **–û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:** –í—ã–∑–≤–∞—Ç—å `componentMetadata.ReinitializeMetaData()`, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è —Ñ–∞–π–ª –∏–ª–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∞ (—á—Ç–æ–±—ã –ø–µ—Ä–µ—á–∏—Ç–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ç–æ–ª–±—Ü–æ–≤).
    *   **–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–û–±–∑–æ—Ä...":** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `IDtsConnectionService` —á–µ—Ä–µ–∑ `serviceProvider`, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ File Connection Manager –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π.
6.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** –ü—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `IErrorCollectionService` –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫ SSIS, –µ—Å–ª–∏ –ø—É—Ç—å –Ω–µ–≤–µ—Ä–Ω—ã–π.
7.  **–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ:** –û–±–µ —Å–±–æ—Ä–∫–∏ (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ UI) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω—ã, —Å–æ–±—Ä–∞–Ω—ã –∏ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –≤ **GAC**. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤ Toolbox, –∞ –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —â–µ–ª—á–∫–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞—à–∞ —É–¥–æ–±–Ω–∞—è —Ñ–æ—Ä–º–∞.

---

‚úÖ **–ò—Ç–æ–≥ –ø–æ –ì–ª–∞–≤–µ 19:**
–≠—Ç–∞ –≥–ª–∞–≤–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ü–∏–∫–ª —Å–æ–∑–¥–∞–Ω–∏—è **–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ, enterprise-—É—Ä–æ–≤–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ SSIS**. –û–Ω–∞ —É—á–∏—Ç, —á—Ç–æ —Ö–æ—Ä–æ—à–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–π –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π "–¥–≤–∏–∂–æ–∫", –Ω–æ –∏ **—É–¥–æ–±–Ω—ã–π, –Ω–∞–¥—ë–∂–Ω—ã–π –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤ —Å—Ä–µ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**. –£–º–µ–Ω–∏–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–∫–æ–π UI –æ—Ç–ª–∏—á–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã "–¥–ª—è —Å–µ–±—è", –æ—Ç —Ç–æ–≥–æ, –∫—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–¥—É–∫—Ç—ã "–¥–ª—è –∫–æ–º–∞–Ω–¥—ã –∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞".
