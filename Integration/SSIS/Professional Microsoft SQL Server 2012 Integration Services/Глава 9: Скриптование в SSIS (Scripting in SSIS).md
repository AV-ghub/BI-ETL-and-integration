## **–ì–ª–∞–≤–∞ 9: –°–∫—Ä–∏–ø—Ç–æ–≤–∞–Ω–∏–µ –≤ SSIS (Scripting in SSIS)**

–≠—Ç–∞ –≥–ª–∞–≤–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é SSIS —á–µ—Ä–µ–∑ –∫–æ–¥**. –ê–≤—Ç–æ—Ä—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—é—Ç –¥–≤–∞ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: **Script Task** (–¥–ª—è Control Flow) –∏ **Script Component** (–¥–ª—è Data Flow), –æ–±—ä—è—Å–Ω—è—è –∏—Ö —Ä–∞–∑–ª–∏—á–∏—è, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –ø—Ä–∏–≤–æ–¥—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤.

---

### üìå **–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å–∫—Ä–∏–ø—Ç–æ–≤–∞–Ω–∏–µ –≤ SSIS**

- **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?** –ö–æ–≥–¥–∞ —à—Ç–∞—Ç–Ω—ã—Ö –∑–∞–¥–∞—á –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è:
    *   –°–ª–æ–∂–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.
    *   –†–∞–±–æ—Ç—ã —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ API –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
    *   –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π —Å —Ñ–∞–π–ª–∞–º–∏, —Ä–µ–µ—Å—Ç—Ä–æ–º –∏ —Ç.–¥.
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: Visual Studio Tools for Applications (VSTA)** ‚Äî —É—Ä–µ–∑–∞–Ω–Ω–∞—è —Å—Ä–µ–¥–∞ Visual Studio, –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø—Ä—è–º–æ –≤ SSDT, —Å IntelliSense, –æ—Ç–ª–∞–¥–∫–æ–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π C#/VB.NET.
- **–î–≤–∞ –ª–∏—Ü–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤–∞–Ω–∏—è:**
    1.  **Script Task** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **Control Flow**. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è *–æ–¥–∏–Ω —Ä–∞–∑* –∑–∞ –∑–∞–ø—É—Å–∫ (–∫–∞–∫ –∏ –ª—é–±–∞—è –∑–∞–¥–∞—á–∞).
    2.  **Script Component** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **Data Flow**. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç *–∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É* –¥–∞–Ω–Ω—ã—Ö (–∏–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫/–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ).

---

### **1. Script Task: –°–∫—Ä–∏–ø—Ç –≤ –ø–æ—Ç–æ–∫–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

#### **A. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–æ –≤–∫–ª–∞–¥–∫–µ Script:**
    *   **ScriptLanguage:** –í—ã–±–æ—Ä C# –∏–ª–∏ VB.NET.
    *   **ReadOnlyVariables / ReadWriteVariables:** **–°–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö SSIS, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤ –∫–æ–¥–µ.** **–í–∞–∂–Ω–µ–π—à–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.**
    *   **Edit Script:** –û—Ç–∫—Ä—ã–≤–∞–µ—Ç VSTA.
- **–û–±—ä–µ–∫—Ç–Ω–∞—è –º–æ–¥–µ–ª—å:** –í–µ—Å—å –∫–æ–¥ –ø–∏—à–µ—Ç—Å—è –≤ –∫–ª–∞—Å—Å–µ `ScriptMain`. –ö–ª—é—á–µ–≤–æ–π –æ–±—ä–µ–∫—Ç ‚Äî `Dts`. –ß–µ—Ä–µ–∑ –Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, —Å–æ–±—ã—Ç–∏—è.
    *   `Dts.Variables["User::MyVar"].Value` ‚Äî —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.
    *   `Dts.TaskResult` ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–¥–∞—á–∏ (`Success`, `Failure`).

#### **B. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Script Task (–∏–∑ –∫–Ω–∏–≥–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ):**

1.  **–î–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º (Accessing Variables):**
    ```csharp
    // C# –ü—Ä–∏–º–µ—Ä: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    if (Dts.Variables.Contains("User::FileName"))
    {
        string filePath = Dts.Variables["User::FileName"].Value.ToString();
        // ... –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å filePath
        Dts.Variables["User::FileExists"].Value = File.Exists(filePath);
    }
    Dts.TaskResult = (int)ScriptResults.Success;
    ```

2.  **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –¥–∞–Ω–Ω—ã—Ö (Connecting to Data Sources):**
    *   Script Task –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ .NET-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (`SqlClient`, `OleDb`) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ Execute SQL Task (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ DDL, —Ä–∞–±–æ—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏).
    ```csharp
    using (SqlConnection conn = new SqlConnection(Dts.Connections["AdventureWorks"].ConnectionString))
    {
        conn.Open();
        // ... –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ–≥–æ SQL
    }
    ```

3.  **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π (Raising an Event):** –ú–æ–∂–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –ø–∞–∫–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `OnWarning`), —á—Ç–æ–±—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π **Event Handler**.
    ```csharp
    Dts.Events.FireWarning(100, "Script Task", "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.", "", 0);
    ```

4.  **–ó–∞–ø–∏—Å—å –≤ –ª–æ–≥ (Writing a Log Entry):** –ü—Ä—è–º–∞—è –∑–∞–ø–∏—Å—å –≤ –º–µ—Ö–∞–Ω–∏–∑–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è SSIS.
    ```csharp
    Dts.Log("–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–ª–æ–∂–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è...", 0, null);
    ```

---

### **2. Script Component: –°–∫—Ä–∏–ø—Ç –≤ –ø–æ—Ç–æ–∫–µ –¥–∞–Ω–Ω—ã—Ö**

#### **A. –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç Script Task:**
- **–†–∞–±–æ—Ç–∞–µ—Ç —Å *–ø–æ—Ç–æ–∫–æ–º* –¥–∞–Ω–Ω—ã—Ö.** –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è *–∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏* (–≤ —Ä–µ–∂–∏–º–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è).
- **–ú–æ–∂–µ—Ç –≤—ã—Å—Ç—É–ø–∞—Ç—å –∫–∞–∫ –ò—Å—Ç–æ—á–Ω–∏–∫ (Source), –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (Transformation) –∏–ª–∏ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ (Destination).**
- **–ò–º–µ–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –∏ –≤—ã—Ö–æ–¥–Ω—ã–µ *–∫–æ–ª–æ–Ω–∫–∏*,** –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ –Ω–∞ —ç—Ç–∞–ø–µ –¥–∏–∑–∞–π–Ω–∞.
- **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—ä–µ–∫—Ç—É `Dts`.** –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–∞–∫–µ—Ç–æ–º —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –≥–µ—Ç—Ç–µ—Ä—ã/—Å–µ—Ç—Ç–µ—Ä—ã.

#### **B. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Script Component:**
1.  –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ç–∏–ø: **Source**, **Transformation**, **Destination**.
2.  –ù–∞ –≤–∫–ª–∞–¥–∫–µ **Input Columns** –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –≤—Ö–æ–¥—è—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏ (–¥–ª—è Transformation/Destination).
3.  –ù–∞ –≤–∫–ª–∞–¥–∫–µ **Inputs and Outputs** –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤—ã—Ö–æ–¥–Ω—ã–µ –±—É—Ñ–µ—Ä—ã –∏ –∫–æ–ª–æ–Ω–∫–∏.
4.  –ù–∞ –≤–∫–ª–∞–¥–∫–µ **Script** –∑–∞–¥–∞—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Script Task) –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä.

#### **C. –ü—Ä–∏–º–µ—Ä: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Data Validation)**
**–°—Ü–µ–Ω–∞—Ä–∏–π:** –í –ø–æ—Ç–æ–∫–µ –¥–∞–Ω–Ω—ã—Ö –Ω—É–∂–Ω–æ –æ—Ç–±—Ä–æ—Å–∏—Ç—å —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ email –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç regex, –∏ –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –∏—Ö.
1.  –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è Script Component, —Ç–∏–ø ‚Äî **Transformation**.
2.  –í **Input Columns** –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∫–æ–ª–æ–Ω–∫–∞ `Email`.
3.  –í **Inputs and Outputs** –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤—Ç–æ—Ä–æ–π –≤—ã—Ö–æ–¥–Ω–æ–π –ø–æ—Ç–æ–∫ `InvalidEmailOutput`.
4.  –í –∫–æ–¥–µ, –≤ –º–µ—Ç–æ–¥–µ `Input0_ProcessInputRow`, –ø–∏—à–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞:
    ```csharp
    // C#
    public override void Input0_ProcessInputRow(Input0Buffer Row)
    {
        string email = Row.Email;
        if (IsValidEmail(email)) // –í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        {
            Row.DirectRowToOutput0(); // –ù–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ "—Ö–æ—Ä–æ—à–∏–π" –≤—ã—Ö–æ–¥
        }
        else
        {
            Row.DirectRowToOutput1(); // –ù–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ "–ø–ª–æ—Ö–æ–π" –≤—ã—Ö–æ–¥ (InvalidEmailOutput)
            // –ú–æ–∂–Ω–æ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é-—Å—á—ë—Ç—á–∏–∫
        }
    }
    ```

#### **D. –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π vs –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–µ–∂–∏–º (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û)**
- **–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (Synchronous):** –ö–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –Ω–∞ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ –æ–¥–∏–Ω–∞–∫–æ–≤–æ. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **row-by-row** –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è). **–ù–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –±—É—Ñ–µ—Ä.**
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (Asynchronous):** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –Ω–∞ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ *–º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è*. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–∞–≥—Ä–µ–≥–∞—Ü–∏–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏** (–∫–∞–∫ —à—Ç–∞—Ç–Ω—ã–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è). **–°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –±—É—Ñ–µ—Ä.** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `SynchronousInputID = None` —É –≤—ã—Ö–æ–¥–∞.

---

### **3. –û—Å–Ω–æ–≤—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—Ç–ª–∞–¥–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫**

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (Structured Exception Handling):** **–í—Å–µ–≥–¥–∞** –æ–±–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ –∫–æ–¥ –≤ `try-catch` –±–ª–æ–∫–∏. –í Script Task —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ `Dts.TaskResult = Failure` –≤ catch-–±–ª–æ–∫–µ.
- **–û—Ç–ª–∞–¥–∫–∞ (Debugging):**
    *   **–¢–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ (Breakpoints):** –†–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –≤ –æ–±—ã—á–Ω–æ–π Visual Studio.
    *   **–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –æ–∫–Ω–∞ (Watch, Locals):** –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
    *   **–ú–µ—Ç–æ–¥—ã `FireInformation`, `FireWarning`:** –î–ª—è –≤—ã–≤–æ–¥–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –æ–∫–Ω–æ Progress.
- **–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
    *   **–°–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞ (Garbage Collection):** –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ —Ü–∏–∫–ª–µ ‚Äî –≤—ã–∑—ã–≤–∞–π—Ç–µ `GC.Collect()` —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é.
    *   **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** Script Component –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º. –ò–∑–±–µ–≥–∞–π—Ç–µ —Ç—è–∂—ë–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ü–∏–∫–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏.

---

### üéØ **–ß—Ç–æ –≤–∞–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –∏–∑ –ì–ª–∞–≤—ã 9:**

1.  **Script Task ‚Äî –¥–ª—è Control Flow,** **Script Component ‚Äî –¥–ª—è Data Flow.** –ù–µ –ø—É—Ç–∞—Ç—å –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ.
2.  **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Äî –º–æ—Å—Ç –º–µ–∂–¥—É SSIS –∏ –∫–æ–¥–æ–º.** –í—Å–µ–≥–¥–∞ —è–≤–Ω–æ –æ–±—ä—è–≤–ª—è–π—Ç–µ –∏—Ö –≤ `ReadOnlyVariables`/`ReadWriteVariables`.
3.  **Script Component –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –∏–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º.** –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –≥–∏–±–∫–∏–º.
4.  **–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º —Ä–µ–∂–∏–º–æ–º –≤ Script Component** ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –±—ã—Å—Ç—Ä–æ–π –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏ –º–æ—â–Ω—ã–º–∏, –Ω–æ –¥–æ—Ä–æ–≥–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –Ω–∞–¥ –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö.
5.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏ –æ—Ç–ª–∞–¥–∫–∞ ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.** –ù–µ –Ω–∞–¥–µ–π—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞.
6.  **–ù–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è–π—Ç–µ —Å–∫—Ä–∏–ø—Ç–∞–º–∏.** –ï—Å–ª–∏ –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —à—Ç–∞—Ç–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ (Lookup, Derived Column) ‚Äî –¥–µ–ª–∞–π—Ç–µ —ç—Ç–æ. –°–∫—Ä–∏–ø—Ç —Å–ª–æ–∂–Ω–µ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å.

---

### ‚ùì **–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –∏–∑ —Ç–µ–º—ã –ì–ª–∞–≤—ã 9:**

*"–í–∞–º –Ω—É–∂–Ω–æ –≤ Data Flow —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —É–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –≤ Conditional Split –∏–ª–∏ Lookup (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã –∏–ª–∏ –ø–∞—Ä—Å–∏–Ω–≥ —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä–æ–∫–∏). –ö–∞–∫ –≤—ã —ç—Ç–æ —Å–¥–µ–ª–∞–µ—Ç–µ?"*

**–ò–¥–µ–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:**
*"–Ø –∏—Å–ø–æ–ª—å–∑—É—é **Script Component** –≤ —Ä–µ–∂–∏–º–µ **Transformation (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)**.*
1.  *–í –¥–∏–∑–∞–π–Ω–µ—Ä–µ Script Component –≤—ã–±–µ—Ä—É –Ω—É–∂–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏.*
2.  *–î–æ–±–∞–≤–ª—é –Ω–æ–≤—ã–π –≤—ã—Ö–æ–¥–Ω–æ–π –ø–æ—Ç–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `InvalidDataOutput`).*
3.  *–í –∫–æ–¥–µ, –≤ –º–µ—Ç–æ–¥–µ `Input0_ProcessInputRow`, —Ä–µ–∞–ª–∏–∑—É—é –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏. –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –≤–∞–ª–∏–¥–Ω–∞, –Ω–∞–ø—Ä–∞–≤–ª—é –µ—ë –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –≤—ã—Ö–æ–¥ (`DirectRowToOutput0`), –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤ –ø–æ—Ç–æ–∫ –¥–ª—è –æ—à–∏–±–æ–∫ (`DirectRowToOutput1`).*
4.  *–ú–æ–≥—É —Ç–∞–∫–∂–µ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å—á—ë—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–∫–µ—Ç–∞, –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–π –≤ `ReadWriteVariables`.*
*–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –¥–∞—ë—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ª–æ–≥–∏–∫–æ–π –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö. –î–ª—è –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ —è —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—é Derived Column –∏ Conditional Split."*

---

### üîß **–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏–∑ –≥–ª–∞–≤—ã:**
- **–ò–º–µ–Ω—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ** –∏ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –∏—Ö –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö —Å–∫—Ä–∏–ø—Ç–∞.
- **–ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥** –≤–Ω—É—Ç—Ä–∏ —Å–∫—Ä–∏–ø—Ç–∞, –æ—Å–æ–±–µ–Ω–Ω–æ —Å–ª–æ–∂–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.
- **–í—ã–Ω–æ—Å–∏—Ç–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –ª–æ–≥–∏–∫—É** –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ .NET-—Å–±–æ—Ä–∫–∏ (Class Library) –∏ –ø–æ–¥–∫–ª—é—á–∞–π—Ç–µ –∏—Ö –∫–∞–∫ —Å—Å—ã–ª–∫–∏. –≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏.
- **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã** –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞.

---

‚úÖ **–ò—Ç–æ–≥ –ø–æ –ì–ª–∞–≤–µ 9:**
–≠—Ç–∞ –≥–ª–∞–≤–∞ **—Å–Ω–∏–º–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ SSIS**. –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –≤ SSIS —á–µ–≥–æ-—Ç–æ –Ω–µ—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" ‚Äî —ç—Ç–æ –Ω–µ —Ç—É–ø–∏–∫. –í–ª–∞–¥–µ–Ω–∏–µ Script Task –∏ Script Component ‚Äî —ç—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫ **Senior-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞**, —Å–ø–æ—Å–æ–±–Ω–æ–≥–æ —Ä–µ—à–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Ç–∞–º, –≥–¥–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –±–µ—Å—Å–∏–ª—å–Ω—ã.
