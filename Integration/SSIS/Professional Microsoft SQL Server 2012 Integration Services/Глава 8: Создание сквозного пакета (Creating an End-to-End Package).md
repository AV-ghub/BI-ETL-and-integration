## **–ì–ª–∞–≤–∞ 8: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫–≤–æ–∑–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ (Creating an End-to-End Package)**

–≠—Ç–∞ –≥–ª–∞–≤–∞ ‚Äî **–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞**. –ê–≤—Ç–æ—Ä—ã –ø—Ä–æ–≤–æ–¥—è—Ç —á–∏—Ç–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –¥–≤–∞ —Å–∫–≤–æ–∑–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞, –Ω–∞—á–∏–Ω–∞—è —Å –ø—Ä–æ—Å—Ç–æ–≥–æ —É—á–µ–±–Ω–æ–≥–æ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º, –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–º –∫ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏. –¶–µ–ª—å ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Control Flow –∏ Data Flow —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ –≤ —Ä–∞–º–∫–∞—Ö –µ–¥–∏–Ω–æ–π ETL-–ª–æ–≥–∏–∫–∏.

---

### üìå **–î–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞ –≥–ª–∞–≤—ã:**

1.  **Basic Transformation Tutorial:** –ü—Ä–æ—Å—Ç–æ–π —É—á–µ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –æ—Å–Ω–æ–≤.
2.  **Typical Mainframe ETL with Data Scrubbing:** –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–π –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–µ–π–Ω—Ñ—Ä–µ–π–º–∞ —Å –æ—á–∏—Å—Ç–∫–æ–π –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.

---

### **–ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤—ã–π —É—á–µ–±–Ω–∏–∫ –ø–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º (Basic Transformation Tutorial)**

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ø–∞–∫–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã SQL Server –≤ –¥—Ä—É–≥—É—é, –≤—ã–ø–æ–ª–Ω—è—è –ø–æ –ø—É—Ç–∏ –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.

#### **–®–∞–≥–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è:**

1.  **–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π (Creating Connections):**
    *   –°–æ–∑–¥–∞—é—Ç—Å—è –¥–≤–∞ **OLE DB Connection Manager**: –æ–¥–∏–Ω –¥–ª—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (`AdventureWorksDW`), –¥—Ä—É–≥–æ–π –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (–Ω–æ–≤–∞—è –∏–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –±–∞–∑–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, `StagingDB`).
    *   *–í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç:* –ê–≤—Ç–æ—Ä—ã –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞—é—Ç, —á—Ç–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

2.  **–°–æ–∑–¥–∞–Ω–∏–µ Control Flow (Creating the Control Flow):**
    *   –ù–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å Control Flow –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî **Data Flow Task**. –í–µ—Å—å ETL –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤–Ω—É—Ç—Ä–∏ –Ω–µ—ë.
    *   –ó–∞–¥–∞—á–µ –¥–∞—ë—Ç—Å—è –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DFT - Extract and Load Sales`).

3.  **–°–æ–∑–¥–∞–Ω–∏–µ Data Flow (Creating the Data Flow):**
    *   –í–Ω—É—Ç—Ä–∏ Data Flow Task —Å—Ç—Ä–æ–∏—Ç—Å—è –∫–æ–Ω–≤–µ–π–µ—Ä:
        *   **–ò—Å—Ç–æ—á–Ω–∏–∫ (Source):** **OLE DB Source**. –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ-–∏—Å—Ç–æ—á–Ω–∏–∫ –∏ —Ç–∞–±–ª–∏—Ü–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `FactInternetSales`).
        *   **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (Transformation):** **Derived Column Transformation**. –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤—ã—á–∏—Å–ª—è–µ–º—ã–π —Å—Ç–æ–ª–±–µ—Ü, –Ω–∞–ø—Ä–∏–º–µ—Ä, `SalesAmountWithTax`, —Ä–∞–≤–Ω—ã–π `SalesAmount * (1 + TaxAmt)`.
        *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ (Destination):** **OLE DB Destination**. –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ-–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Ü–µ–ª–µ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞. –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã –Ω–µ—Ç, –µ—ë –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä—è–º–æ –∑–¥–µ—Å—å.
    *   –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è "—Ç—Ä—É–±–∞–º–∏" (paths).

4.  **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ (Completing and Saving the Package):**
    *   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–∞ (–Ω–µ—Ç –∫—Ä–∞—Å–Ω—ã—Ö –∫—Ä–µ—Å—Ç–∏–∫–æ–≤/–≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤).
    *   –ü–∞–∫–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

5.  **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ (Executing the Package):**
    *   –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç–ª–∞–¥–∫–∞ (F5). –ê–≤—Ç–æ—Ä—ã –æ–±—Ä–∞—â–∞—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∑–µ–ª—ë–Ω—ã–µ –≥–∞–ª–æ—á–∫–∏, –æ–∑–Ω–∞—á–∞—é—â–∏–µ —É—Å–ø–µ—Ö, –∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Progress/Execution Results**, –≥–¥–µ –º–æ–∂–Ω–æ –≤–∏–¥–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫.

**–ò—Ç–æ–≥ –ø—Ä–∏–º–µ—Ä–∞ 1:** –ü–æ–∫–∞–∑–∞–Ω–∞ **–±–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞ SSIS**: Control Flow –∫–∞–∫ –¥–∏—Ä–∏–∂—ë—Ä, Data Flow –∫–∞–∫ –æ—Ä–∫–µ—Å—Ç—Ä, –≤—ã–ø–æ–ª–Ω—è—é—â–∏–π —Ä–∞–±–æ—Ç—É. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω.

---

### **–ü—Ä–∏–º–µ—Ä 2: –¢–∏–ø–∏—á–Ω—ã–π ETL –∏–∑ –º–µ–π–Ω—Ñ—Ä–µ–π–º–∞ —Å –æ—á–∏—Å—Ç–∫–æ–π –¥–∞–Ω–Ω—ã—Ö (Typical Mainframe ETL with Data Scrubbing)**

–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä —Å–ª–æ–∂–Ω–µ–µ –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–µ–µ. –ò–º–∏—Ç–∏—Ä—É–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–º–µ–π–Ω—Ñ—Ä–µ–π–º–∞), –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –Ω–∏–∑–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ –ø–∞–ø–∫—É `C:\MainframeExtract\` –ø–æ—Å—Ç—É–ø–∞–µ—Ç —Ñ–∞–π–ª `SalesData.txt`. –ï–≥–æ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ staging-—Ç–∞–±–ª–∏—Ü—É, –æ—á–∏—Å—Ç–∏—Ç—å, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∑–∞—Ç–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –∏—Ç–æ–≥–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É. –§–∞–π–ª –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω—É–∂–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å.

#### **–®–∞–≥–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è (–ª–æ–≥–∏–∫–∞ –ø–∞–∫–µ—Ç–∞):**

1.  **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ (Control Flow) —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–æ–∂–Ω–µ–µ:**
    *   **–ó–∞–¥–∞—á–∞ 1: File System Task** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `SalesData.txt` –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –ø–∞–ø–∫–µ. –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç, –ø–∞–∫–µ—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.
    *   **–ó–∞–¥–∞—á–∞ 2: Data Flow Task** (–æ—Å–Ω–æ–≤–Ω–∞—è) ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –∏ –æ—á–∏—Å—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö. *–ö –Ω–µ–π –º—ã –≤–µ—Ä–Ω—ë–º—Å—è.*
    *   **–ó–∞–¥–∞—á–∞ 3: Execute SQL Task** ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é –≤—Å—Ç–∞–≤–∫—É –æ—á–∏—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ staging-—Ç–∞–±–ª–∏—Ü—ã –≤ –∏—Ç–æ–≥–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É, –∏—Å–ø–æ–ª—å–∑—É—è –Ω–∞–±–æ—Ä–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é (`INSERT ... SELECT`).
    *   **–ó–∞–¥–∞—á–∞ 4: File System Task** ‚Äî –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ñ–∞–π–ª `SalesData.txt` –≤ –ø–∞–ø–∫—É `C:\MainframeExtract\Archive\`.
    *   –í—Å–µ –∑–∞–¥–∞—á–∏ —Å–≤—è–∑–∞–Ω—ã **Precedence Constraints** –ø–æ —É—Å–ª–æ–≤–∏—é `Success`.

2.  **Data Flow (—è–¥—Ä–æ –ø—Ä–∏–º–µ—Ä–∞) ‚Äî –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
    *   **–ò—Å—Ç–æ—á–Ω–∏–∫:** **Flat File Source**, –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–π –∫ `SalesData.txt`. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ (—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏, —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö) ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —à–∞–≥.
    *   **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ 1: Data Conversion** ‚Äî –ø—Ä–∏–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –Ω—É–∂–Ω—ã–µ —Ç–∏–ø—ã (—Å—Ç—Ä–æ–∫–∏ –≤ —á–∏—Å–ª–∞, –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–∞—Ç). –í—ã—Ö–æ–¥ "—Å –æ—à–∏–±–∫–∞–º–∏" (–∫—Ä–∞—Å–Ω–∞—è —Å—Ç—Ä–µ–ª–∫–∞) –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ **Flat File Destination** –¥–ª—è –∑–∞–ø–∏—Å–∏ "–ø–ª–æ—Ö–∏—Ö" —Å—Ç—Ä–æ–∫ –≤ –ª–æ–≥-—Ñ–∞–π–ª `BadRows.log`.
    *   **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ 2: Derived Column** ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã: `LoadDate` (—Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞) –∏ `FileName` (–∏–º—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π).
    *   **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ 3: Lookup Transformation** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ProductID`) –ø–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É –≤ –ë–î. –°—Ç—Ä–æ–∫–∏ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤—ã—Ö–æ–¥ (–ø–æ—Ç–æ–∫ –æ—à–∏–±–æ–∫).
    *   **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤:** –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —É –Ω–∞—Å —É–∂–µ —Ç—Ä–∏ –ø–æ—Ç–æ–∫–∞:
        1.  **"–•–æ—Ä–æ—à–∏–µ" –¥–∞–Ω–Ω—ã–µ** (–ø—Ä–æ—à–µ–¥—à–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –∏ Lookup).
        2.  **"–ü–ª–æ—Ö–∏–µ" –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏** (–∑–∞–ø–∏—Å–∞–Ω—ã –≤ `BadRows.log`).
        3.  **"–ü–ª–æ—Ö–∏–µ" –¥–∞–Ω–Ω—ã–µ –∏–∑ Lookup** (–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∫–æ–¥—ã).
    *   **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è "—Ö–æ—Ä–æ—à–∏—Ö" –¥–∞–Ω–Ω—ã—Ö:** **OLE DB Destination** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –≤ staging-—Ç–∞–±–ª–∏—Ü—É `stg_SalesData`.

3.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ "–ø–ª–æ—Ö–∏—Ö" –¥–∞–Ω–Ω—ã—Ö (Handling More Bad Data):**
    *   –ê–≤—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ "–ø–ª–æ—Ö–∏—Ö" –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é **Union All Transformation** –∏ –∑–∞–ø–∏—Å–∞—Ç—å –∏—Ö –≤ –µ–¥–∏–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –æ—à–∏–±–æ–∫ (`ErrorLog`) –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –≠—Ç–æ –ª—É—á—à–µ, —á–µ–º —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ –ª–æ–≥-—Ñ–∞–π–ª—ã.

4.  **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–Ω–æ—Å—Ç–∏ –∏ –¥–∏–Ω–∞–º–∏–∫–∏ (Looping and the Dynamic Tasks):**
    *   **–£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è:** –§–∞–π–ª–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ. –ê–≤—Ç–æ—Ä—ã –Ω–∞–º–µ–∫–∞—é—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ **Foreach Loop Container**, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ –≤—Å–µ–º —Ñ–∞–π–ª–∞–º `*.txt` –≤ –ø–∞–ø–∫–µ.
    *   **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –∫–∞–∫ —Å –ø–æ–º–æ—â—å—é **–≤—ã—Ä–∞–∂–µ–Ω–∏–π (Expressions)** —Å–¥–µ–ª–∞—Ç—å –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ Flat File Connection Manager –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º, –∑–∞–≤–∏—Å—è—â–∏–º –æ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, –∫–æ—Ç–æ—Ä—É—é —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Foreach Loop.

---

### üéØ **–ö–ª—é—á–µ–≤—ã–µ —É—Ä–æ–∫–∏ –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∏–∑ –ì–ª–∞–≤—ã 8:**

1.  **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å (Modularity):** –†–∞–∑–±–∏–≤–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ Control Flow. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É, –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏.
2.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (Error Handling) ‚Äî —ç—Ç–æ –Ω–µ –æ–ø—Ü–∏—è:** –í—Å–µ–≥–¥–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è—Ö Data Flow (–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏). "–ü–ª–æ—Ö–∏–µ" –¥–∞–Ω–Ω—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –ª–æ–º–∞—Ç—å –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å; –∏—Ö –Ω—É–∂–Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å.
3.  **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (Separation of Concerns):** Data Flow –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ —á–∏—Å—Ç–∏—Ç –¥–∞–Ω–Ω—ã–µ, Execute SQL Task ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–æ–∂–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –≤—Å—Ç–∞–≤–∫–∏, File System Task ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª–∞–º–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.
4.  **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Staging-—Ç–∞–±–ª–∏—Ü:** –ó–∞–≥—Ä—É–∑–∫–∞ —Å–Ω–∞—á–∞–ª–∞ –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É (`stg_`), –∞ –∑–∞—Ç–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ ‚Äî —ç—Ç–æ –Ω–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç:
    *   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É.
    *   –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—â–µ —Å–¥–µ–ª–∞—Ç—å SQL.
    *   –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤ —Å–ª—É—á–∞–µ —Å–±–æ—è.
5.  **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Logging):** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π (`LoadDate`, `FileName`) –≤ –¥–∞–Ω–Ω—ã–µ ‚Äî —ç—Ç–æ —Ñ–æ—Ä–º–∞ –∞—É–¥–∏—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –æ—á–µ–Ω—å –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ —Ç—Ä–∞–±–ª—à—É—Ç–∏–Ω–≥–µ.
6.  **–û—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É:** –ù–∞—á–Ω–∏—Ç–µ —Å —Ä–∞–±–æ—á–µ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ –ø–∞–∫–µ—Ç–∞, –∑–∞—Ç–µ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ü–∏–∫–ª—ã.

---

### ‚ùì **–ü—Ä–∏–º–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –ø–æ –º–æ—Ç–∏–≤–∞–º –ì–ª–∞–≤—ã 8:**

*"–û–ø–∏—à–∏—Ç–µ, –∫–∞–∫ –±—ã –≤—ã –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –ø–∞–∫–µ—Ç –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV-—Ñ–∞–π–ª–∞ –≤ SQL Server, —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏–µ–π —Ñ–∞–π–ª–∞."*

**–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç (–æ—Ç—Ä–∞–∂–∞—é—â–∏–π –ø–æ–¥—Ö–æ–¥ –∏–∑ –≥–ª–∞–≤—ã):**
1.  **Control Flow:**
    *   **–®–∞–≥ 1 (–ü—Ä–æ–≤–µ—Ä–∫–∞):** File System Task –∏–ª–∏ Script Task –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–∞.
    *   **–®–∞–≥ 2 (–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞):** Data Flow Task ‚Äî —è–¥—Ä–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
    *   **–®–∞–≥ 3 (–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞):** Execute SQL Task –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ö—Ä–∞–Ω–∏–º–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –æ—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ staging –≤ —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É.
    *   **–®–∞–≥ 4 (–ê—Ä—Ö–∏–≤–∞—Ü–∏—è):** File System Task –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É –∞—Ä—Ö–∏–≤–∞ (—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –¥–∞—Ç—ã –≤ –∏–º—è).
2.  **Data Flow (–≤–Ω—É—Ç—Ä–∏ –®–∞–≥–∞ 2):**
    *   **Flat File Source** —á–∏—Ç–∞–µ—Ç CSV.
    *   **Data Conversion** –ø—Ä–∏–≤–æ–¥–∏—Ç —Ç–∏–ø—ã, –æ—à–∏–±–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –ø–æ—Ç–æ–∫ "Bad Data".
    *   **Derived Column** –¥–æ–±–∞–≤–ª—è–µ—Ç `LoadTimestamp`.
    *   **Lookup** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–¥–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤).
    *   **Conditional Split** –º–æ–∂–µ—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞–º.
    *   **OLE DB Destination** ("Good Data") –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ staging-—Ç–∞–±–ª–∏—Ü—É.
    *   **–î—Ä—É–≥–æ–π OLE DB Destination –∏–ª–∏ Flat File Destination** ("Bad Data") —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä–æ–∫–∏ —Å –æ—à–∏–±–∫–∞–º–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
3.  **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
    *   –î–æ–±–∞–≤–∏–ª –±—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –±—ã –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏.
    *   –ù–∞—Å—Ç—Ä–æ–∏–ª –±—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è `OnError` –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–∞–∫–µ—Ç–∞ —Å Send Mail Task –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö.

---

‚úÖ **–ò—Ç–æ–≥ –ø–æ –ì–ª–∞–≤–µ 8:**
–≠—Ç–æ –≥–ª–∞–≤–∞-**–º–æ—Å—Ç–∏–∫ –º–µ–∂–¥—É —Ç–µ–æ—Ä–∏–µ–π –∏ –ø—Ä–∞–∫—Ç–∏–∫–æ–π**. –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ SSIS ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∞ **—Ü–µ–ª–æ—Å—Ç–Ω–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –Ω–∞–¥—ë–∂–Ω—ã—Ö, —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö ETL-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤**. –û—Å–Ω–æ–≤–Ω–æ–π –≤—ã–≤–æ–¥: **–ø—Ä–æ–µ–∫—Ç–∏—Ä—É–π—Ç–µ –ø–∞–∫–µ—Ç—ã —Å —É—á—ë—Ç–æ–º –æ—à–∏–±–æ–∫, —è—Å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.**
